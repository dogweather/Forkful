---
title:                "קריאת ארגומנטים משורת הפקודה"
aliases:
- /he/vba/reading-command-line-arguments/
date:                  2024-02-01T22:00:18.280580-07:00
model:                 gpt-4-0125-preview
simple_title:         "קריאת ארגומנטים משורת הפקודה"
tag:                  "Files and I/O"
editURL:              "https://github.com/dogweather/forkful/blob/master/content/he/vba/reading-command-line-arguments.md"
changelog:
  - 2024-02-01, gpt-4-0125-preview, translated from English
---

{{< edit_this_page >}}

## מה ולמה?

קריאת ארגומנטים של שורת הפקודה ב-Visual Basic for Applications (VBA) כוללת גישה לפרמטרים שהועברו לתוכנית שלך בעת ההפעלה. הטכניקה הזו משמשת לעיתים קרובות להשפיע על התנהגות או פלט של תוכנית ללא הצורך באינטרקציה מצד המשתמש, מה שהופך משימות של אוטומציה וכתיבת סקריפטים להרבה יותר פשוטות וגמישות.

## איך לעשות:

בניגוד לסביבות תכנות יותר פשוטות, ל-VBA אין תכונה מובנית לקרוא ארגומנטים של שורת פקודה בחוש אקונוונציונלי מפני שהוא מיועד בעיקר להטמעה בתוך יישומי Microsoft Office. עם זאת, עם קצת יצירתיות, אנו יכולים להשתמש ב-Windows Script Host (WSH) או לקרוא ל-APIs חיצוניים כדי להשיג פונקציונליות דומה. הנה פתרון פרקטי באמצעות WSH:

1. **יצירת VBScript להעברת ארגומנטים ל-VBA:**

   תחילה, כתבו קובץ VBScript (*yourScript.vbs*) שמפעיל את היישום VBA שלכם (למשל, מאקרו של Excel) ומעביר את ארגומנטי שורת הפקודה:

```vb
Set objExcel = CreateObject("Excel.Application")
objExcel.Workbooks.Open "C:\YourMacroWorkbook.xlsm"
objExcel.Run "YourMacroName", WScript.Arguments.Item(0), WScript.Arguments.Item(1)
objExcel.Quit
```

2. **גישה לארגומנטים ב-VBA:**

   ביישום VBA שלכם (*YourMacroWorkbook.xlsm*), שנו או צרו מחדש את המאקרו (*YourMacroName*) כך שיקבל פרמטרים:

```vb
Sub YourMacroName(arg1 As String, arg2 As String)
    MsgBox "ארגומנט 1: " & arg1 & " ארגומנט 2: " & arg2
End Sub
```

3. **הפעלת הסקריפט שלכם:**

   הפעילו את ה-VBScript משורת הפקודה, תוך העברת הארגומנטים כפי הצורך:

```shell
cscript yourScript.vbs "שלום" "עולם"
```

   זה אמור להוביל לביצוע המאקרו VBA שלכם עם הארגומנטים "שלום" ו"עולם", ולהציג אותם בתיבת הודעה.

## חקירה מעמיקה:

בהקשר ההיסטורי, VBA נועד להרחיב את יכולות היישומים של Microsoft Office, ולא כסביבת תכנות עצמאית. כתוצאה מכך, אינטרקציה ישירה עם שורת הפקודה היא מחוץ לתחום העיקרי שלו, מה שמסביר את היעדר התמיכה המובנית לקריאת ארגומנטים של שורת פקודה.

השיטה שהוצגה לעיל, אף על פי שהיא יעילה, היא יותר פתרון זמני מאשר פתרון מובנה, שמנצלת סקריפטינג חיצוני כדי לגשר על הפער. גישה זו יכולה להכניס סיבוכיות ודאגות פוטנציאליות לאבטחה, מכיוון שהיא דורשת הפעלה של מאקרואים ולעיתים קרובות ירידה בהגדרות האבטחה כדי להריץ.

למשימות שתלויות באופן רב בארגומנטים של שורת פקודה או שזקוקות לאינטגרציה חלקה יותר עם מערכת ההפעלה של Windows, שפות תכנות אחרות כמו PowerShell או Python עשויות להציע פתרונות יותר חזקים ובטוחים. האלטרנטיבות הללו מספקות תמיכה ישירה בארגומנטים של שורת פקודה והן מתאימות יותר ליישומים או סקריפטים עצמאיים שדורשים קלט חיצוני כדי לשנות את התנהגותם בצורה דינמית.
