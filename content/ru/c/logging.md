---
title:                "Журналирование"
date:                  2024-01-28T23:59:43.582925-07:00
model:                 gpt-4-0125-preview
simple_title:         "Журналирование"

tag:                  "Good Coding Practices"
editURL:              "https://github.com/dogweather/forkful/blob/master/content/ru/c/logging.md"
changelog:
  - 2024-01-28, gpt-4-0125-preview, translated from English
---

{{< edit_this_page >}}

## Что и Почему?
Логирование – это ведение записей о действиях вашей программы, обычно путём записи сообщений в файл или терминал. Программисты делают это для отслеживания событий, диагностики проблем и создания аудиторского журнала, который рассказывает историю работы приложения во времени.

## Как сделать:
Давайте начнем с основ. В C нет встроенного фреймворка для логирования, но вы можете создать что-то простое с помощью `stdio.h`. Вот как:

```c
#include <stdio.h>
#include <time.h>

void logMessage(const char* message) {
    time_t now;
    time(&now);
    char *date = ctime(&now);
    date[strlen(date) - 1] = '\0'; // Удалите символ новой строки в конце результата ctime()
    printf("[%s] %s\n", date, message);
}

int main() {
    logMessage("Приложение запущено.");
    // ... ваш код здесь ...
    logMessage("Приложение выполняет что-то важное.");
    // ... код продолжается ...
    logMessage("Приложение завершено.");
    return 0;
}
```

Пример вывода может выглядеть так:

```
[Tue Mar 9 12:00:01 2023] Приложение запущено.
[Tue Mar 9 12:00:02 2023] Приложение выполняет что-то важное.
[Tue Mar 9 12:00:03 2023] Приложение завершено.
```

Конечно, в реальном мире вы, вероятно, захотите писать в файл, а не в терминал, обрабатывать разные уровни логов и, возможно, использовать предопределенную библиотеку.

## Углубляемся
Логирование в C обладает своей прелестью – оно настолько низкоуровневое, как и большая часть остального языка. Исторически логирование выполнялось с использованием `fprintf` с `stderr` или указателем на файл. По мере усложнения программ, усложнялись и потребности в логировании, что привело к разработке библиотек, таких как `syslog` в системах Unix, которые могли обрабатывать логирование из множества источников с различными уровнями важности.

В современном ландшафте существует множество библиотек логирования для C, таких как `zlog`, `log4c` и `glog`, которые предлагают богатый набор функций, включая ротацию логов, структурированное логирование и многопоточное логирование. Эти решения позволяют точно контролировать громкость логов, направления и форматы.

При реализации системы логирования необходимо учитывать такие детали, как форматирование временных меток, управление файлами логов и производительность. Маркировка логов временем критически важна для корреляции событий, в то время как ротация логов гарантирует, что файлы логов не займут слишком много места на диске. Процесс логирования также должен быть быстрым и не блокировать основной поток приложения, чтобы избежать превращения логирования в узкое место.

## См. также
Для более глубокого изучения библиотек и практик логирования в C ознакомьтесь с этими ресурсами:

- Руководство по `syslog` от GNU: https://www.gnu.org/software/libc/manual/html_node/Syslog.html
- `zlog`: Высококонфигурируемая библиотека логирования для C - https://github.com/HardySimpson/zlog
- `log4c`: Фреймворк логирования для C, сделанный на подобие Log4j - http://log4c.sourceforge.net/
- `glog`: Библиотека логирования уровня приложений от Google - https://github.com/google/glog
