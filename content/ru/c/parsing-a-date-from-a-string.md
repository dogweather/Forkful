---
title:                "Анализ даты из строки"
date:                  2024-01-29T00:00:21.482617-07:00
model:                 gpt-4-0125-preview
simple_title:         "Анализ даты из строки"

tag:                  "Dates and Times"
editURL:              "https://github.com/dogweather/forkful/blob/master/content/ru/c/parsing-a-date-from-a-string.md"
changelog:
  - 2024-01-28, gpt-4-0125-preview, translated from English
---

{{< edit_this_page >}}

## Что и Почему?

Разбор даты из строки означает извлечение и преобразование даты, выраженной в текстовом виде, в структурированный формат, с которым программа может понимать и работать. Программисты делают это, потому что даты в текстовой форме неудобны для расчетов, сравнений или хранения в стандартизированном формате.

## Как это сделать:

Вот небольшое руководство по разбору строки с датой на языке C с использованием `strptime()` из `time.h`. Оно считывает дату в формате `"YYYY-MM-DD"` и преобразует ее в `struct tm`.

```C
#include <stdio.h>
#include <time.h>

int main() {
    const char *date_str = "2023-03-14";
    struct tm tm;
    
    // Очищаем структуру, чтобы избежать мусорных значений
    memset(&tm, 0, sizeof(struct tm));
    
    // Разбираем строку с датой
    if (strptime(date_str, "%Y-%m-%d", &tm) == NULL) {
        printf("Не удалось разобрать дату.\n");
        return 1;
    }

    // Выводим разобранную дату
    printf("Год: %d, Месяц: %d, День: %d\n", tm.tm_year + 1900, tm.tm_mon + 1, tm.tm_mday);

    return 0;
}
```

Пример вывода:
```
Год: 2023, Месяц: 3, День: 14
```

## Погружение в детали

Когда-то давно даты были болезненной темой в C, программистам приходилось вручную разбирать строки, возясь с `strtok()`, `sscanf()` или даже с прямыми циклами и проверками символов. Но потом появилась `strptime()` как часть POSIX, позволяя нам конвертировать строки, представляющие время, в `struct tm` с предопределенными форматами.

Существуют альтернативы, такие как `getdate()`, но они не используются так широко. И есть ручной метод - прямое манипулирование строками, но давайте не будем возвращаться в темные времена, ладно?

С точки зрения реализации, `strptime()` действительно требует от вас очистки вашей `struct tm`, потому что сама функция этого за вас не сделает. Если вы пропустите этот этап очистки с использованием `memset()`, вы можете получить случайный мусор в неиспользуемых полях, что приведет к неожиданным результатам.

Помните, `strptime()` является частью POSIX, так что если вы находитесь в не-POSIX системе, такой как Windows, вам нужно будет искать другое решение или слой совместимости, например, реализации `win32` или сторонние библиотеки.

## Смотрите также

- [Библиотека `<chrono>` в C++](https://en.cppreference.com/w/cpp/header/chrono)
Для тех, кто также занимается C++ и ищет более современный подход к манипулированию датами и временем.

Хотя фокус здесь на C, более глубокое понимание функций времени POSIX всегда плюс.

- [Поведение strftime и strptime](https://man7.org/linux/man-pages/man3/strptime.3.html)
Страница справочника для `strptime()` и `strftime()`, чтобы понимать, как форматировать время в C.

Когда играете со временем и датами, остерегайтесь часовых поясов и изменений летнего времени — они могут всё испортить, если с ними не обращаться должным образом. Счастливого кодинга!
