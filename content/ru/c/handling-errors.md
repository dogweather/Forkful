---
title:                "Обработка ошибок"
date:                  2024-01-28T23:58:56.906736-07:00
model:                 gpt-4-0125-preview
simple_title:         "Обработка ошибок"

tag:                  "Good Coding Practices"
editURL:              "https://github.com/dogweather/forkful/blob/master/content/ru/c/handling-errors.md"
changelog:
  - 2024-01-28, gpt-4-0125-preview, translated from English
---

{{< edit_this_page >}}

## Что и Почему?
Обработка ошибок в языке C заключается в ожидании непредвиденного. Это предотвращает сбои программ при возникновении проблем. Программисты делают это для того, чтобы изящно обрабатывать ошибки и делать свой код надежным.

## Как:

Давайте посмотрим, как это сделать на C:

```C
#include <stdio.h>
#include <stdlib.h>
#include <errno.h>

int main() {
    FILE *fp = fopen("nonexistentfile.txt", "r");
    if (fp == NULL) {
        perror("Ошибка открытия файла");
        return EXIT_FAILURE;
    }
    // Что-то делаем с файлом
    fclose(fp);
    return EXIT_SUCCESS;
}
```

Пример вывода, когда файла не существует:
```
Ошибка открытия файла: Нет такого файла или каталога
```

## Глубже

В начале времен C обработка ошибок была минимальной - в основном коды возврата и ручные проверки. Появляется `errno`, глобальная переменная, обновляемая при сбоях функций. Она сама по себе не является потокобезопасной, поэтому были введены новые функции `strerror` и `perror` для лучшей отчетности об ошибках.

Альтернативы? Современный C не ограничивается `errno`. Есть setjmp и longjmp для нелокальных переходов, когда случается катастрофа. Некоторые предпочитают определять свои коды ошибок, в то время как другие выбирают структуры, похожие на исключения в C++.

Детали реализации могут быть сложными. Например, `errno` является потокобезопасной в POSIX-совместимых системах благодаря магии Локального Хранилища Потоков (TLS). Во встроенных системах, где ресурсы ценны, пользовательский код обработки ошибок может быть предпочтительнее стандартных подходов, которые могут увеличить размер программного обеспечения.

## Смотрите также

- Подробное изучение `errno`: https://en.cppreference.com/w/c/error/errno
- Для потоковой безопасности см. POSIX-потоки и errno: http://man7.org/linux/man-pages/man3/pthread_self.3.html
- Введение в setjmp и longjmp: https://www.cplusplus.com/reference/csetjmp/
- Для обработки исключений в C++, смотрите: https://isocpp.org/wiki/faq/exceptions
