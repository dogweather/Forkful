---
aliases:
- /ru/google-apps-script/working-with-csv/
changelog:
- 2024-02-01, gpt-4-0125-preview, translated from English
date: 2024-02-01 22:05:35.123920-07:00
description: "\u0420\u0430\u0431\u043E\u0442\u0430 \u0441 \u0444\u0430\u0439\u043B\
  \u0430\u043C\u0438 CSV (Comma-Separated Values, \u0437\u043D\u0430\u0447\u0435\u043D\
  \u0438\u044F, \u0440\u0430\u0437\u0434\u0435\u043B\u0451\u043D\u043D\u044B\u0435\
  \ \u0437\u0430\u043F\u044F\u0442\u044B\u043C\u0438) \u0432 Google Apps Script \u0432\
  \u043A\u043B\u044E\u0447\u0430\u0435\u0442 \u0432 \u0441\u0435\u0431\u044F \u0447\
  \u0442\u0435\u043D\u0438\u0435, \u0438\u0437\u043C\u0435\u043D\u0435\u043D\u0438\
  \u0435 \u0438 \u0437\u0430\u043F\u0438\u0441\u044C \u0442\u0435\u043A\u0441\u0442\
  \u043E\u0432\u044B\u0445\u2026"
lastmod: 2024-02-18 23:08:56.509116
model: gpt-4-0125-preview
summary: "\u0420\u0430\u0431\u043E\u0442\u0430 \u0441 \u0444\u0430\u0439\u043B\u0430\
  \u043C\u0438 CSV (Comma-Separated Values, \u0437\u043D\u0430\u0447\u0435\u043D\u0438\
  \u044F, \u0440\u0430\u0437\u0434\u0435\u043B\u0451\u043D\u043D\u044B\u0435 \u0437\
  \u0430\u043F\u044F\u0442\u044B\u043C\u0438) \u0432 Google Apps Script \u0432\u043A\
  \u043B\u044E\u0447\u0430\u0435\u0442 \u0432 \u0441\u0435\u0431\u044F \u0447\u0442\
  \u0435\u043D\u0438\u0435, \u0438\u0437\u043C\u0435\u043D\u0435\u043D\u0438\u0435\
  \ \u0438 \u0437\u0430\u043F\u0438\u0441\u044C \u0442\u0435\u043A\u0441\u0442\u043E\
  \u0432\u044B\u0445\u2026"
title: "\u0420\u0430\u0431\u043E\u0442\u0430 \u0441 CSV"
---

{{< edit_this_page >}}

## Что и Почему?

Работа с файлами CSV (Comma-Separated Values, значения, разделённые запятыми) в Google Apps Script включает в себя чтение, изменение и запись текстовых файлов, где каждая строка представляет собой запись данных с значениями, разделёнными запятыми. Программисты делают это для того, чтобы легко обмениваться данными между различными приложениями, базами данных или языками программирования из-за широкого принятия CSV как простого текстового формата обмена данными.

## Как сделать:

### Чтение данных CSV

Чтобы прочитать данные CSV из файла, хранящегося в Google Drive, сначала нужно получить содержимое файла в виде строки, затем разобрать его. Google Apps Script упрощает получение содержимого файла с помощью сервиса DriveApp.

```javascript
function readCSV() {
  var fileId = 'YOUR_FILE_ID_HERE'; // Замените на реальный идентификатор файла
  var file = DriveApp.getFileById(fileId);
  var content = file.getBlob().getDataAsString();
  var rows = content.split("\n");
  
  for (var i = 0; i < rows.length; i++) {
    var cells = rows[i].split(",");
    Logger.log(cells); // Записываем ячейки каждой строки
  }
}
```

### Запись данных CSV

Создание и запись в CSV включает в себя конструирование строки с разделёнными запятыми значениями и переносами строк, затем сохранение или экспорт. В этом примере показано создание нового CSV файла в Google Drive.

```javascript
function writeCSV() {
  var folderId = 'YOUR_FOLDER_ID_HERE'; // Замените на идентификатор папки Drive, где будет создан новый файл
  var csvContent = "Name,Age,Occupation\nJohn Doe,29,Engineer\nJane Smith,34,Designer";
  var fileName = "example.csv";
  
  var folder = DriveApp.getFolderById(folderId);
  folder.createFile(fileName, csvContent, MimeType.PLAIN_TEXT);
}
```

### Примеры результатов

При записи ячеек строк из CSV файла:

```plaintext
[John, 29, Engineer]
[Jane, 34, Designer]
```

При записи создаётся файл с именем "example.csv" со следующим содержимым:

```plaintext
Name,Age,Occupation
John Doe,29,Engineer
Jane Smith,34,Designer
```

## Углублённое изучение

Исторически файлы CSV пользовались популярностью из-за их простоты и удобочитаемости для человека, что делает их доступными для не программистов и полезными для быстрых задач по осмотру данных. Однако, Google Apps Script работает в пределах экосистемы Google, где Google Таблицы действуют как мощная, удобная для пользователя альтернатива для манипулирования CSV. Таблицы не только предоставляют графический интерфейс для редактирования данных, но и поддерживают сложные формулы, стили и многое другое, чего не хватает необработанным CSV.

Несмотря на преимущества, предлагаемые Google Таблицами, прямое манипулирование CSV в Google Apps Script остаётся важным для автоматических задач, особенно при работе с внешними системами, которые генерируют или требуют данные в формате CSV. Например, интеграция с устаревшими системами, экспорт данных для использования в других приложениях, или предварительная обработка перед загрузкой данных в Google Таблицы.

Более того, возможности Google Apps Script по работе с файлами CSV могут быть расширены с помощью службы Utilities для продвинутых нужд кодирования или взаимодействия с внешними API для задач конвертации, разбора или валидации. Однако, для работы с большими наборами данных или требующими сложных манипуляций, стоит рассмотреть использование API Google Таблиц или исследовать возможности BigQuery для более мощных возможностей обработки данных.

Пока простота остаётся ключевой причиной популярности CSV, эти альтернативы предлагают богатый набор функций для работы с данными в обширной экосистеме Google Cloud.
