---
title:                "Разбор даты из строки"
date:                  2024-02-01T21:58:28.845368-07:00
model:                 gpt-4-0125-preview
simple_title:         "Разбор даты из строки"
tag:                  "Dates and Times"
editURL:              "https://github.com/dogweather/forkful/blob/master/content/ru/google-apps-script/parsing-a-date-from-a-string.md"
changelog:
  - 2024-02-01, gpt-4-0125-preview, translated from English
---

{{< edit_this_page >}}

## Что и почему?

Разбор даты из строки включает преобразование текста, который представляет дату, в объект даты, что позволяет программистам выполнять операции, связанные с датой, такие как сравнения, арифметические операции и форматирование. Это необходимо для обработки ввода пользователя, обработки данных из внешних источников и управления датами в различных форматах, особенно в приложениях, связанных с планированием, анализом данных или любыми формами записей, основанных на времени.

## Как это сделать:

В Google Apps Script, который основан на JavaScript, у вас есть несколько подходов к разбору даты из строки. Ниже приведены примеры, использующие как нативные методы JavaScript, так и утилиты Google Apps Script.

**Использование конструктора `new Date()`:**

Самый простой способ разобрать строку в дату в Google Apps Script — использование конструктора объекта `Date`. Однако это требует, чтобы строка даты была в формате, распознаваемом методом Date.parse() (например, ГГГГ-ММ-ДД).

```javascript
const dateString = '2023-04-01';
const dateObject = new Date(dateString);
Logger.log(dateObject); // Выводит Sat Apr 01 2023 00:00:00 GMT+0000 (UTC)
```

**Использование `Utilities.parseDate()`:**

Для большей гибкости, особенно с пользовательскими форматами дат, Google Apps Script предоставляет `Utilities.parseDate()`. Этот метод позволяет указать формат даты, часовой пояс и локаль.

```javascript
const dateString = '01-04-2023'; // ДД-ММ-ГГГГ
const format = 'dd-MM-yyyy';
const timezone = Session.getScriptTimeZone();
const dateObject = Utilities.parseDate(dateString, timezone, format);
Logger.log(dateObject); // Выводит Sat Apr 01 2023 00:00:00 GMT+0000 (UTC) в зависимости от часового пояса скрипта
```

Примечание: Хотя `Utilities.parseDate()` предлагает больше контроля, его поведение может варьироваться в зависимости от часового пояса скрипта, поэтому крайне важно явно указывать часовой пояс, если ваше приложение обрабатывает даты в разных регионах.

## Глубокое погружение

Разбор дат в языках программирования традиционно сопряжен с трудностями, прежде всего из-за разнообразия форматов дат и сложностей с часовыми поясами. Подход Google Apps Script, в основном заимствованный у JavaScript, стремится упростить это, предлагая как простой объект `Date`, так и более универсальную функцию `Utilities.parseDate()`. Однако каждый метод имеет свои ограничения; например, использование конструктора `Date` со строками приводит к несоответствиям в разных средах из-за различного толкования форматов дат. С другой стороны, `Utilities.parseDate()` требует более четкого понимания формата, часового пояса и локали, делая его немного более сложным, но более надежным для конкретных потребностей.

Альтернативные библиотеки или сервисы, такие как Moment.js (сейчас рекомендующий Luxon для новых проектов), предоставляют более богатые функциональные возможности и лучшее управление часовыми поясами, решая многие из этих задач. Тем не менее, в контексте Google Apps Script, где внешние библиотеки имеют ограничения, понимание и эффективное использование встроенных методов становится критически важным. Программисты, пришедшие из других языков, могут найти нюансы обработки дат в Google Apps Script уникально сложными, но могут достичь надежного разбора дат с глубоким пониманием доступных инструментов и тщательным учетом глобального характера их приложений.
