---
changelog:
- 2024-02-01, gpt-4-0125-preview, translated from English
date: 2024-02-01 21:57:36.561260-07:00
description: "\u0420\u0430\u0437\u0431\u043E\u0440 HTML \u0432 Google Apps Script\
  \ \u0432\u043A\u043B\u044E\u0447\u0430\u0435\u0442 \u0438\u0437\u0432\u043B\u0435\
  \u0447\u0435\u043D\u0438\u0435 \u0434\u0430\u043D\u043D\u044B\u0445 \u0438\u0437\
  \ HTML-\u0441\u043E\u0434\u0435\u0440\u0436\u0438\u043C\u043E\u0433\u043E, \u0447\
  \u0442\u043E \u043E\u0441\u043E\u0431\u0435\u043D\u043D\u043E \u043F\u043E\u043B\
  \u0435\u0437\u043D\u043E \u043F\u0440\u0438 \u0432\u0437\u0430\u0438\u043C\u043E\
  \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0438 \u0441\u043E \u0432\u0435\u0431\
  -\u0441\u0442\u0440\u0430\u043D\u0438\u0446\u0430\u043C\u0438 \u0438\u043B\u0438\
  \ \u0432\u0435\u0431-\u2026"
lastmod: '2024-03-13T22:44:44.186537-06:00'
model: gpt-4-0125-preview
summary: "\u0420\u0430\u0437\u0431\u043E\u0440 HTML \u0432 Google Apps Script \u0432\
  \u043A\u043B\u044E\u0447\u0430\u0435\u0442 \u0438\u0437\u0432\u043B\u0435\u0447\u0435\
  \u043D\u0438\u0435 \u0434\u0430\u043D\u043D\u044B\u0445 \u0438\u0437 HTML-\u0441\
  \u043E\u0434\u0435\u0440\u0436\u0438\u043C\u043E\u0433\u043E, \u0447\u0442\u043E\
  \ \u043E\u0441\u043E\u0431\u0435\u043D\u043D\u043E \u043F\u043E\u043B\u0435\u0437\
  \u043D\u043E \u043F\u0440\u0438 \u0432\u0437\u0430\u0438\u043C\u043E\u0434\u0435\
  \u0439\u0441\u0442\u0432\u0438\u0438 \u0441\u043E \u0432\u0435\u0431-\u0441\u0442\
  \u0440\u0430\u043D\u0438\u0446\u0430\u043C\u0438 \u0438\u043B\u0438 \u0432\u0435\
  \u0431-\u043E\u0441\u043D\u043E\u0432\u0430\u043D\u043D\u044B\u043C\u0438 \u0438\
  \u0441\u0442\u043E\u0447\u043D\u0438\u043A\u0430\u043C\u0438 \u0434\u0430\u043D\u043D\
  \u044B\u0445."
title: "\u0410\u043D\u0430\u043B\u0438\u0437 HTML"
weight: 43
---

## Как:
Google Apps Script не имеет встроенного метода для разбора HTML. Однако, вы можете использовать сервис `UrlFetchApp` для получения HTML-содержимого, а затем использовать методы JavaScript или regex (регулярные выражения) для разбора. Ниже приведен базовый пример того, как извлечь и разобрать тег заголовка с веб-страницы.

```javascript
function parseHTMLTitle(url) {
  // Получение HTML-содержимого веб-страницы
  const response = UrlFetchApp.fetch(url);
  const htmlContent = response.getContentText();

  // Используйте простой regex, чтобы найти содержимое тега <title>
  const titleRegex = /<title>(.*?)<\/title>/;
  const match = htmlContent.match(titleRegex);

  // Проверьте, найден ли заголовок, и верните его
  if (match && match.length > 1) {
    return match[1];
  }

  return 'Заголовок не найден';
}

// Пример использования
const url = 'http://example.com';
const pageTitle = parseHTMLTitle(url);
Logger.log(pageTitle); // Выводит заголовок веб-страницы
```

Для более сложного разбора HTML вы можете использовать `XmlService` для разбора HTML как XML. Однако, учтите, что это требует, чтобы HTML был хорошо сформированным XML, что не всегда бывает:

```javascript
function parseHTMLUsingXmlService(htmlContent) {
  try {
    const document = XmlService.parse(htmlContent);
    const rootElement = document.getRootElement();
    // Отсюда, перемещайтесь по дереву XML с методами XmlService
    // Например, для поиска конкретного элемента или атрибута
  } catch(e) {
    Logger.log('Ошибка при разборе HTML: ' + e.toString());
  }
}
```

## Глубокое погружение:
Исторически сложилось, что разбор HTML в таких средах, как Google Apps Script, был затруднен из-за отсутствия объектной модели документа (DOM) или специализированных библиотек для разбора, которые распространены в других контекстах программирования. JavaScript в браузере, например, имеет DOM доступный сразу, и среды Node.js имеют доступ к множеству пакетов NPM, таких как `cheerio` или `jsdom`, для разбора HTML.

Подход Google Apps Script в большой степени опирается на использование `UrlFetchApp` для веб-запросов, а затем на манипулирование полученными данными с помощью методов разбора regex или XML. Хотя regex может быть полезен для простых задач разбора, его использование обычно не рекомендуется для сложного HTML из-за риска ошибок и потенциально хрупкой природы кода. Разбор XML с помощью `XmlService` предлагает более структурированный подход, но требует хорошо сформированного HTML/XML, что может быть ограничением при работе с произвольными веб-страницами.

Для сложных потребностей в разборе или при работе с плохо сформированным HTML одной из альтернативных стратегий может являться использование веб-сервиса, внешнего по отношению к Google Apps Script. Этот сервис мог бы обрабатывать HTML-содержимое, возможно, используя более надежный метод или библиотеку для разбора, а затем возвращать обработанные данные в форме, легко потребляемой Google Apps Script. Однако этот подход вводит задержки сети и сложность управления дополнительным веб-сервисом.

Несмотря на эти проблемы, разбор HTML в рамках Google Apps Script остается мощным инструментом, особенно при его сочетании с другими сервисами и API Google, предоставляя ряд возможностей для автоматизации, которые могут значительно повысить производительность и возможности обработки данных.
