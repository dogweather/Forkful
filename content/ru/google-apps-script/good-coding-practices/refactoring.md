---
changelog:
- 2024-02-01, gpt-4-0125-preview, translated from English
date: 2024-02-01 22:00:26.994806-07:00
description: "\u0420\u0435\u0444\u0430\u043A\u0442\u043E\u0440\u0438\u043D\u0433 \u0432\
  \ \u043B\u0435\u043A\u0441\u0438\u043A\u043E\u043D\u0435 \u043F\u0440\u043E\u0433\
  \u0440\u0430\u043C\u043C\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u044F \u043E\u0442\
  \u043D\u043E\u0441\u0438\u0442\u0441\u044F \u043A \u043F\u0440\u043E\u0446\u0435\
  \u0441\u0441\u0443 \u0440\u0435\u0441\u0442\u0440\u0443\u043A\u0442\u0443\u0440\u0438\
  \u0437\u0430\u0446\u0438\u0438 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044E\
  \u0449\u0435\u0433\u043E \u043A\u043E\u043C\u043F\u044C\u044E\u0442\u0435\u0440\u043D\
  \u043E\u0433\u043E \u043A\u043E\u0434\u0430 \u2014 \u0438\u0437\u043C\u0435\u043D\
  \u0435\u043D\u0438\u0435 \u0435\u0433\u043E \u0444\u0430\u043A\u0442\u043E\u0440\
  \u0438\u043D\u0433\u0430 \u0431\u0435\u0437 \u0438\u0437\u043C\u0435\u043D\u0435\
  \u043D\u0438\u044F\u2026"
lastmod: '2024-03-13T22:44:44.207118-06:00'
model: gpt-4-0125-preview
summary: "\u0420\u0435\u0444\u0430\u043A\u0442\u043E\u0440\u0438\u043D\u0433 \u0432\
  \ \u043B\u0435\u043A\u0441\u0438\u043A\u043E\u043D\u0435 \u043F\u0440\u043E\u0433\
  \u0440\u0430\u043C\u043C\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u044F \u043E\u0442\
  \u043D\u043E\u0441\u0438\u0442\u0441\u044F \u043A \u043F\u0440\u043E\u0446\u0435\
  \u0441\u0441\u0443 \u0440\u0435\u0441\u0442\u0440\u0443\u043A\u0442\u0443\u0440\u0438\
  \u0437\u0430\u0446\u0438\u0438 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044E\
  \u0449\u0435\u0433\u043E \u043A\u043E\u043C\u043F\u044C\u044E\u0442\u0435\u0440\u043D\
  \u043E\u0433\u043E \u043A\u043E\u0434\u0430 \u2014 \u0438\u0437\u043C\u0435\u043D\
  \u0435\u043D\u0438\u0435 \u0435\u0433\u043E \u0444\u0430\u043A\u0442\u043E\u0440\
  \u0438\u043D\u0433\u0430 \u0431\u0435\u0437 \u0438\u0437\u043C\u0435\u043D\u0435\
  \u043D\u0438\u044F \u0435\u0433\u043E \u0432\u043D\u0435\u0448\u043D\u0435\u0433\
  \u043E \u043F\u043E\u0432\u0435\u0434\u0435\u043D\u0438\u044F \u2014 \u0441 \u0446\
  \u0435\u043B\u044C\u044E \u0443\u043B\u0443\u0447\u0448\u0435\u043D\u0438\u044F\
  \ \u043D\u0435\u0444\u0443\u043D\u043A\u0446\u0438\u043E\u043D\u0430\u043B\u044C\
  \u043D\u044B\u0445 \u0430\u0442\u0440\u0438\u0431\u0443\u0442\u043E\u0432."
title: "\u0420\u0435\u0444\u0430\u043A\u0442\u043E\u0440\u0438\u043D\u0433"
weight: 19
---

## Как:
В Google Apps Script обычный сценарий, который выигрывает от рефакторинга, это упрощение громоздких скриптов, которые взаимодействуют с Google Sheets или Docs. Изначально скрипты могут быть написаны быстро и грязно, чтобы быстро получить результаты. Со временем, по мере роста скрипта, он становится неудобоваримым. Давайте рассмотрим пример рефакторинга для лучшей читаемости и эффективности.

**Оригинальный скрипт:**

```javascript
function logSheetNames() {
  var sheets = SpreadsheetApp.getActiveSpreadsheet().getSheets();
  for (var i = 0; i < sheets.length; i++) {
    Logger.log(sheets[i].getName());
  }
}
```

Эта функция регистрирует название каждого листа в Google Таблицах. Хотя она работает нормально, она использует устаревшие практики JavaScript и не обладает ясностью.

**Рефакторинг скрипта:**

```javascript
function logSheetNames() {
  const sheets = SpreadsheetApp.getActiveSpreadsheet().getSheets();
  sheets.forEach(sheet => Logger.log(sheet.getName()));
}
```

В рефакторинговой версии мы переключились на использование `const` для переменных, которые не изменяются, делая нашу цель более ясной. Мы также использовали метод `forEach`, более современный и краткий подход к итерации по массивам, улучшая читаемость.

**Пример вывода (для обоих скриптов):**

Вывод в Logger будет выглядеть примерно так, предполагая, что ваш документ Google Таблицы имеет два листа с названиями "Расходы" и "Доходы":

```
[20-04-2023 10:00:00: INFO] Расходы
[20-04-2023 10:00:01: INFO] Доходы
```

Рефакторинговый скрипт достигает того же результата, но более чистый и легче понять с первого взгляда.

## Глубокое погружение
Рефакторинг в Google Apps Script частично наследует свои принципы из более широкой практики программной инженерии. Он стал более узнаваемым и структурированным как концепция в конце 1990-х годов, особенно благодаря фундаментальной книге Мартина Фаулера "Рефакторинг: Улучшение дизайна существующего кода" (1999), которая предоставила комплексное руководство по различным техникам рефакторинга. Хотя конкретика рефакторинга может варьироваться в зависимости от языков программирования из-за их синтаксических и функциональных различий, основная цель остаётся той же: улучшение кода без изменения его внешнего поведения.

В контексте Google Apps Script ключевым аспектом, который следует учитывать во время рефакторинга, являются квоты и ограничения на сервисы, налагаемые Google. Эффективно рефакторингованный код не только лучше читается, но также работает быстрее и надежнее в рамках этих ограничений. Например, пакетные операции (`Range.setValues()` вместо установки значений в каждую ячейку по отдельности) могут значительно сократить время выполнения и потребление квот.

Важно отметить, однако, что для некоторых сложных проектов Google Apps Script может оказаться недостаточным из-за этих самых ограничений. В таких случаях, рассмотрение альтернатив, таких как Google Cloud Functions или новый собрат Apps Script — AppSheet, может предложить лучшую масштабируемость и функциональность.

В конечном итоге, хотя рефакторинг является критически важным навыком в поддержке и улучшении проектов Google Apps Script, понимание ограничений среды и рассмотрение альтернативных решений не менее важны для создания эффективного, надежного и поддерживаемого кода.
