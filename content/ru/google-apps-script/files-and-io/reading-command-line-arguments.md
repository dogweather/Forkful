---
title:                "Чтение аргументов командной строки"
aliases:
- /ru/google-apps-script/reading-command-line-arguments/
date:                  2024-02-01T22:00:29.210581-07:00
model:                 gpt-4-0125-preview
simple_title:         "Чтение аргументов командной строки"
tag:                  "Files and I/O"
editURL:              "https://github.com/dogweather/forkful/blob/master/content/ru/google-apps-script/reading-command-line-arguments.md"
changelog:
  - 2024-02-01, gpt-4-0125-preview, translated from English
---

{{< edit_this_page >}}

## Что и почему?

Чтение аргументов командной строки в Google Apps Script является в некотором роде неправильным термином, потому что, в отличие от традиционных интерфейсов командной строки в таких языках программирования, как Python или Node.js, Google Apps Script изначально не поддерживает выполнение команд из командной строки или анализ аргументов. Вместо этого программисты часто имитируют этот процесс через пользовательские функции и параметры URL при запуске веб-приложений или автоматизированных задач, что позволяет динамично взаимодействовать с функционалом скрипта на основе пользовательских вводов или предопределенных параметров.

## Как это сделать:

Чтобы имитировать процесс чтения аргументов командной строки в Google Apps Script, особенно для веб-приложений, вы можете использовать параметры строки запроса. Когда пользователь доступает к URL веб-приложения, вы можете добавить аргументы, такие как `?name=John&age=30`, и анализировать их внутри вашего кода Apps Script. Вот как вы можете это настроить:

```javascript
function doGet(e) {
  var params = e.parameter; // Получает параметры строки запроса
  var name = params['name']; // Получает параметр 'name'
  var age = params['age']; // Получает параметр 'age'

  // Пример вывода:
  var output = "Имя: " + name + ", Возраст: " + age;
  return HtmlService.createHtmlOutput(output);
}

// Пример URL: https://script.google.com/macros/s/your_script_id/exec?name=John&age=30
```

Когда вы обращаетесь к URL с указанными параметрами, скрипт выдает что-то вроде:

```
Имя: John, Возраст: 30
```

Такой подход является инструментальным для создания персонализированных взаимодействий в веб-приложениях или программного управления выполнением скриптов.

## Погружение

Аргументы командной строки, как их понимают в контексте традиционных языков программирования, предоставляют возможности для скриптов и приложений обработать параметры времени выполнения, тем самым обеспечивая гибкое и динамичное выполнение кода на основе ввода пользователя или автоматизированных процессов. Google Apps Script, являясь облачным языком сценариев для разработки легковесных приложений в экосистеме Google Workspace, не работает нативно через интерфейс командной строки. Вместо этого его выполнение в основном основано на событиях или запускается вручную через UI Apps Script и Google Workspace, или через веб-приложения, которые могут анализировать параметры URL как псевдо аргументы командной строки.

Учитывая это архитектурное различие, программистам, пришедшим из языков с активным использованием CLI, возможно, придется корректировать свой подход при автоматизации задач или разработке приложений в Google Apps Script. Вместо традиционного разбора аргументов командной строки, использование функциональности веб-приложений Google Apps Script или даже пользовательских функций Google Sheets для интерактивной обработки данных может служить аналогичным целям. Хотя это может показаться ограничением сначала, это способствует разработке более дружественных интерфейсов и доступных веб-приложений, соответствуя фокусу Google Apps Script на бесшовной интеграции и расширении приложений Google Workspace.

В сценариях, где точное имитирование поведения CLI имеет первостепенное значение (например, при автоматизации задач с динамическими параметрами), разработчики могут исследовать использование внешних платформ, которые вызывают веб-приложения Google Apps Script, передавая параметры через URL как метод "командной строки". Однако для нативных проектов Google Apps Script обычно приводит к более простым и поддерживаемым решениям принятие модели, ориентированной на события и UI платформы.
