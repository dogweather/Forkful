---
changelog:
- 2024-01-28, gpt-4-0125-preview, translated from English
date: 2024-01-28 23:58:24.320722-07:00
description: "\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u043D\
  \u0438\u0435 \u0444\u0430\u0439\u043B\u043E\u0432 \u043D\u0430 \u043C\u0435\u0441\
  \u0442\u0435 \u0441 \u043F\u043E\u043C\u043E\u0449\u044C\u044E \u043E\u0434\u043D\
  \u043E\u0441\u0442\u0440\u043E\u0447\u043D\u044B\u0445 \u043A\u043E\u043C\u0430\u043D\
  \u0434 CLI (Command Line Interface) \u043D\u0430 Ruby \u043F\u043E\u0437\u0432\u043E\
  \u043B\u044F\u0435\u0442 \u0432\u0430\u043C \u0438\u0437\u043C\u0435\u043D\u044F\
  \u0442\u044C \u0444\u0430\u0439\u043B\u044B \u043D\u0435\u043F\u043E\u0441\u0440\
  \u0435\u0434\u0441\u0442\u0432\u0435\u043D\u043D\u043E \u0438\u0437 \u0432\u0430\
  \u0448\u0435\u0433\u043E\u2026"
lastmod: '2024-03-13T22:44:45.990115-06:00'
model: gpt-4-0125-preview
summary: "\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u043D\
  \u0438\u0435 \u0444\u0430\u0439\u043B\u043E\u0432 \u043D\u0430 \u043C\u0435\u0441\
  \u0442\u0435 \u0441 \u043F\u043E\u043C\u043E\u0449\u044C\u044E \u043E\u0434\u043D\
  \u043E\u0441\u0442\u0440\u043E\u0447\u043D\u044B\u0445 \u043A\u043E\u043C\u0430\u043D\
  \u0434 CLI (Command Line Interface) \u043D\u0430 Ruby \u043F\u043E\u0437\u0432\u043E\
  \u043B\u044F\u0435\u0442 \u0432\u0430\u043C \u0438\u0437\u043C\u0435\u043D\u044F\
  \u0442\u044C \u0444\u0430\u0439\u043B\u044B \u043D\u0435\u043F\u043E\u0441\u0440\
  \u0435\u0434\u0441\u0442\u0432\u0435\u043D\u043D\u043E \u0438\u0437 \u0432\u0430\
  \u0448\u0435\u0433\u043E \u0442\u0435\u0440\u043C\u0438\u043D\u0430\u043B\u0430\
  , \u0431\u0435\u0437 \u043D\u0435\u043E\u0431\u0445\u043E\u0434\u0438\u043C\u043E\
  \u0441\u0442\u0438 \u043E\u0442\u043A\u0440\u044B\u0432\u0430\u0442\u044C \u0438\
  \u0445 \u0432 \u0440\u0435\u0434\u0430\u043A\u0442\u043E\u0440\u0435, \u0432\u043D\
  \u043E\u0441\u0438\u0442\u044C \u0438\u0437\u043C\u0435\u043D\u0435\u043D\u0438\u044F\
  \ \u0438 \u0441\u043E\u0445\u0440\u0430\u043D\u044F\u0442\u044C \u043E\u0431\u0440\
  \u0430\u0442\u043D\u043E."
title: "\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u043D\u0438\
  \u0435 \u0444\u0430\u0439\u043B\u043E\u0432 \u043D\u0430 \u043C\u0435\u0441\u0442\
  \u0435 \u0441 \u043F\u043E\u043C\u043E\u0449\u044C\u044E \u043E\u0434\u043D\u043E\
  \u0441\u0442\u0440\u043E\u0447\u043D\u0438\u043A\u043E\u0432 CLI"
weight: 32
---

## Как это сделать:
Ruby предоставляет простой способ редактирования файлов на месте прямо из командной строки. Используя переключатель `-i` в Ruby, вы можете указать Ruby работать непосредственно с предоставленным(и) файлом(ами). Давайте рассмотрим несколько примеров, чтобы увидеть, как это работает на практике. Представьте, что у вас есть файл `greetings.txt` со следующим содержимым:

```
Привет, мир!
Привет, Ruby!
Привет, программирование!
```

И вы хотите заменить слово "Привет" на "Приветствую". Вот как вы можете это сделать:

```Ruby
ruby -i -pe "gsub(/Привет/, 'Приветствую')" greetings.txt
```

После выполнения этой команды `greetings.txt` будет обновлен до:

```
Приветствую, мир!
Приветствую, Ruby!
Приветствую, программирование!
```

Если вы беспокоитесь о возможности испортить данные, Ruby позаботился о вас. Предоставив расширение для переключателя `-i`, Ruby создает резервную копию перед выполнением изменений. Например:

```Ruby
ruby -i.bak -pe "gsub(/Привет/, 'Пока')" greetings.txt
```

Теперь, вместе с вашим отредактированным `greetings.txt`, вы найдете `greetings.txt.bak` в той же директории, содержащий исходное содержимое.

## Глубокое погружение
Магия редактирования файлов на месте в Ruby исходит из его сочетания возможностей обработки текста, аналогичных Perl, и собственной синтаксической элегантности Ruby. Исторически Perl был языком выбора для быстрого написания однострочных скриптов, особенно для манипуляции текстом. Ruby перенял этот подход, позволяя обладать мощными возможностями скриптов на командной строке.

Существуют альтернативы для редактирования на месте на других языках, таких как сам Perl и sed, редактор потоков в системах Unix. У каждого из них есть свои сильные стороны — Perl известен своей мощью в обработке текста, в то время как sed непревзойден в своей простоте для задач редактирования потоков. Однако, Ruby предлагает баланс, обеспечивая надежную манипуляцию текстом с более читаемым и удобным для пользователя синтаксисом, особенно для тех, кто уже знаком с Ruby.

С точки зрения реализации, редактирование файлов на месте в Ruby работает путем переименования оригинального файла, создания нового с оригинальным именем файла, а затем записи изменений в этот новый файл по мере чтения из переименованного оригинала. Этот подход обеспечивает атомарность операции; либо весь файл обрабатывается успешно, либо изменения не вносятся, защищая целостность ваших данных в процессе редактирования. Этот механизм, в сочетании с обработкой исключений Ruby, также обеспечивает устойчивость к прерываниям, таким как сбои питания или прерывания процессов, гарантируя, что по крайней мере резервная копия остается нетронутой.

В заключение, редактирование файлов на месте в Ruby — это свидетельство его полезности как языка скриптов, предлагающее сочетание мощи, простоты и элегантности для задач манипуляции текстом непосредственно из командной строки.
