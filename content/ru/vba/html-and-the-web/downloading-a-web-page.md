---
changelog:
- 2024-02-01, gpt-4-0125-preview, translated from English
date: 2024-02-01 21:52:56.803269-07:00
description: "\u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430 \u0432\u0435\u0431\
  -\u0441\u0442\u0440\u0430\u043D\u0438\u0446\u044B \u0432 Visual Basic for Applications\
  \ (VBA) \u0432\u043A\u043B\u044E\u0447\u0430\u0435\u0442 \u043F\u043E\u043B\u0443\
  \u0447\u0435\u043D\u0438\u0435 HTML-\u0441\u043E\u0434\u0435\u0440\u0436\u0438\u043C\
  \u043E\u0433\u043E \u0432\u0435\u0431-\u0441\u0442\u0440\u0430\u043D\u0438\u0446\
  \u044B \u0438\u0437 \u0418\u043D\u0442\u0435\u0440\u043D\u0435\u0442\u0430. \u041F\
  \u0440\u043E\u0433\u0440\u0430\u043C\u043C\u0438\u0441\u0442\u044B \u0447\u0430\u0441\
  \u0442\u043E \u0432\u044B\u043F\u043E\u043B\u043D\u044F\u044E\u0442\u2026"
lastmod: '2024-03-13T22:44:44.740336-06:00'
model: gpt-4-0125-preview
summary: "\u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430 \u0432\u0435\u0431-\u0441\
  \u0442\u0440\u0430\u043D\u0438\u0446\u044B \u0432 Visual Basic for Applications\
  \ (VBA) \u0432\u043A\u043B\u044E\u0447\u0430\u0435\u0442 \u043F\u043E\u043B\u0443\
  \u0447\u0435\u043D\u0438\u0435 HTML-\u0441\u043E\u0434\u0435\u0440\u0436\u0438\u043C\
  \u043E\u0433\u043E \u0432\u0435\u0431-\u0441\u0442\u0440\u0430\u043D\u0438\u0446\
  \u044B \u0438\u0437 \u0418\u043D\u0442\u0435\u0440\u043D\u0435\u0442\u0430."
title: "\u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430 \u0432\u0435\u0431-\u0441\
  \u0442\u0440\u0430\u043D\u0438\u0446\u044B"
weight: 42
---

## Как это сделать:
Для загрузки веб-страницы в VBA можно использовать библиотеку Microsoft XML версии 6.0 (MSXML6), которая позволяет отправлять серверные HTTP-запросы. Прежде чем приступить к коду, убедитесь, что вы включили эту ссылку в своем редакторе VBA, перейдя в `Инструменты` -> `Ссылки` и отметив `Microsoft XML, v6.0`.

Вот простой пример того, как загрузить HTML-содержимое веб-страницы:

```basic
Sub DownloadWebPage()
    Dim request As Object
    Dim url As String
    Dim response As String
    
    ' Инициализация объекта XML HTTP запроса
    Set request = CreateObject("MSXML2.XMLHTTP")
    
    url = "http://www.example.com"
    
    ' Открытие синхронного запроса
    request.Open "GET", url, False
    
    ' Отправка запроса на сервер
    request.send
    
    ' Получение текста ответа
    response = request.responseText
    
    ' Вывод ответа в окно немедленного выполнения (для целей отладки)
    Debug.Print response
    
    ' Очистка
    Set request = Nothing
End Sub
```

Запуск этой подпрограммы выведет HTML `http://www.example.com` в окно немедленного выполнения в редакторе VBA. Заметьте, что параметр `False` в методе `Open` делает запрос синхронным, то есть код будет ждать, пока веб-страница не будет загружена, прежде чем перейти к следующей строке.

## Глубокое Погружение
Показанная техника основывается на MSXML, реализации Microsoft стандарта XML HTTP Request, часто используемого для AJAX-запросов в веб-разработке. Этот компонент является частью технологического стека Microsoft уже долгое время, что делает его надежным выбором для сетевых запросов в VBA.

Однако зависимость от MSXML и VBA для загрузки и анализа веб-контента может быть ограничивающей, особенно для современных веб-приложений, которые интенсивно используют JavaScript для динамической отрисовки контента. Эти ограничения могут сделать другие языки или инструменты, такие как Python с библиотеками вроде BeautifulSoup или Selenium, более подходящими для задач веб-скрапинга из-за их способности выполнять JavaScript и обрабатывать сложные взаимодействия на веб-сайтах.

Тем не менее, для простых задач, связанных с получением прямолинейного HTML-содержимого или при работе в рамках приложений Office, VBA остается практичным инструментом. Его интеграция в пакет Office позволяет напрямую манипулировать документами на основе веб-контента, предлагая уникальное преимущество для определенных случаев использования.
