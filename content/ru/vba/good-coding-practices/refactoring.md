---
changelog:
- 2024-02-01, gpt-4-0125-preview, translated from English
date: 2024-02-01 22:00:19.268127-07:00
description: "\u0420\u0435\u0444\u0430\u043A\u0442\u043E\u0440\u0438\u043D\u0433 \u0432\
  \ \u043F\u0440\u043E\u0433\u0440\u0430\u043C\u043C\u0438\u0440\u043E\u0432\u0430\
  \u043D\u0438\u0438 \u043F\u043E\u0434\u0440\u0430\u0437\u0443\u043C\u0435\u0432\u0430\
  \u0435\u0442 \u0438\u0437\u043C\u0435\u043D\u0435\u043D\u0438\u0435 \u0441\u0442\
  \u0440\u0443\u043A\u0442\u0443\u0440\u044B \u043A\u043E\u0434\u0430 \u0431\u0435\
  \u0437 \u0438\u0437\u043C\u0435\u043D\u0435\u043D\u0438\u044F \u0435\u0433\u043E\
  \ \u043F\u043E\u0432\u0435\u0434\u0435\u043D\u0438\u044F \u0441 \u0446\u0435\u043B\
  \u044C\u044E \u0443\u043B\u0443\u0447\u0448\u0435\u043D\u0438\u044F \u0442\u0430\
  \u043A\u0438\u0445 \u0430\u0441\u043F\u0435\u043A\u0442\u043E\u0432, \u043A\u0430\
  \u043A \u0447\u0438\u0442\u0430\u0435\u043C\u043E\u0441\u0442\u044C,\u2026"
lastmod: '2024-03-13T22:44:44.758103-06:00'
model: gpt-4-0125-preview
summary: "\u0420\u0435\u0444\u0430\u043A\u0442\u043E\u0440\u0438\u043D\u0433 \u0432\
  \ \u043F\u0440\u043E\u0433\u0440\u0430\u043C\u043C\u0438\u0440\u043E\u0432\u0430\
  \u043D\u0438\u0438 \u043F\u043E\u0434\u0440\u0430\u0437\u0443\u043C\u0435\u0432\u0430\
  \u0435\u0442 \u0438\u0437\u043C\u0435\u043D\u0435\u043D\u0438\u0435 \u0441\u0442\
  \u0440\u0443\u043A\u0442\u0443\u0440\u044B \u043A\u043E\u0434\u0430 \u0431\u0435\
  \u0437 \u0438\u0437\u043C\u0435\u043D\u0435\u043D\u0438\u044F \u0435\u0433\u043E\
  \ \u043F\u043E\u0432\u0435\u0434\u0435\u043D\u0438\u044F \u0441 \u0446\u0435\u043B\
  \u044C\u044E \u0443\u043B\u0443\u0447\u0448\u0435\u043D\u0438\u044F \u0442\u0430\
  \u043A\u0438\u0445 \u0430\u0441\u043F\u0435\u043A\u0442\u043E\u0432, \u043A\u0430\
  \u043A \u0447\u0438\u0442\u0430\u0435\u043C\u043E\u0441\u0442\u044C, \u043F\u043E\
  \u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u043C\u043E\u0441\u0442\u044C\
  \ \u0438\u043B\u0438 \u043F\u0440\u043E\u0438\u0437\u0432\u043E\u0434\u0438\u0442\
  \u0435\u043B\u044C\u043D\u043E\u0441\u0442\u044C."
title: "\u0420\u0435\u0444\u0430\u043A\u0442\u043E\u0440\u0438\u043D\u0433"
weight: 19
---

## Как это делается:
Рассмотрим простой пример на Visual Basic для Приложений (VBA), где у нас есть подпрограмма, которая печатает детали сотрудника. Изначально код перегружен, его сложно поддерживать или расширять.

```vb
Sub PrintEmployeeDetails()
    Dim name As String
    Dim age As Integer
    Dim department As String
    name = "John Doe"
    age = 30
    department = "IT"
    
    MsgBox "Имя: " & name & vbCrLf & "Возраст: " & age & vbCrLf & "Отдел: " & department
End Sub
```

Шаг рефакторинга 1: Выделение метода. Одна из самых распространенных техник рефакторинга - это выделение определенного куска кода в свой собственный метод. Это делает код более модульным и легче для понимания.

```vb
Sub PrintEmployeeDetails()
    Dim name As String
    Dim age As Integer
    Dim department As String
    name = "John Doe"
    age = 30
    department = "IT"
    
    ПоказатьСообщение name, age, department
End Sub

Private Sub ПоказатьСообщение(name As String, age As Integer, department As String)
    MsgBox "Имя: " & name & vbCrLf & "Возраст: " & age & vbCrLf & "Отдел: " & department
End Sub
```

Шаг рефакторинга 2: Использование структуры. Этот шаг включает в себя использование структуры данных для хранения связанных данных, что улучшает ясность кода и упрощает передачу сгруппированных данных.

```vb
Type Сотрудник
    name As String
    age As Integer
    department As String
End Type

Sub PrintEmployeeDetails()
    Dim emp As Сотрудник
    emp.name = "John Doe"
    emp.age = 30
    emp.department = "IT"
    
    ПоказатьСообщение emp
End Sub

Private Sub ПоказатьСообщение(emp As Сотрудник)
    MsgBox "Имя: " & emp.name & vbCrLf & "Возраст: " & emp.age & vbCrLf & "Отдел: " & emp.department
End Sub
```

Эти шаги преобразуют перегруженный код в модульный, структурированный код, значительно улучшая читаемость и поддерживаемость.

## Глубокое погружение
Концепция рефакторинга стара, как само программирование, но книга Мартина Фаулера "Refactoring: Improving the Design of Existing Code" вывела его на главную сцену, подчеркнув его важность в процессе разработки программного обеспечения. В Visual Basic для Приложений рефакторинг может быть несколько более сложным из-за отсутствия встроенных инструментов, доступных в более современных интегрированных средах разработки (IDEs), поддерживающих автоматизированный рефакторинг.

Однако это не умаляет его важности. Даже в VBA применение базовых техник рефакторинга вручную может значительно улучшить код, делая его чище и более эффективным. Хотя у VBA может не быть таких же современных удобств, принципы хорошего дизайна кода остаются универсальными. Разработчики, приходящие из других языков, могут найти ручной процесс утомительным, но безусловно оценят преимущества вложения времени в улучшение качества кода с самого начала.

Для более мощных сред разработки или при работе над особенно сложными проектами может быть целесообразно исследовать альтернативы, предлагающие более мощные инструменты рефакторинга или преобразование проектов VBA в язык .NET, где Visual Studio предоставляет обширную поддержку рефакторинга. Тем не менее, понимание и применение принципов рефакторинга в VBA является ценным навыком, подчеркивающим важность написания чистого, поддерживаемого кода, независимо от среды.
