---
title:                "Чтение аргументов командной строки"
aliases:
- ru/vba/reading-command-line-arguments.md
date:                  2024-02-01T21:59:38.689136-07:00
model:                 gpt-4-0125-preview
simple_title:         "Чтение аргументов командной строки"
tag:                  "Files and I/O"
editURL:              "https://github.com/dogweather/forkful/blob/master/content/ru/vba/reading-command-line-arguments.md"
changelog:
  - 2024-02-01, gpt-4-0125-preview, translated from English
---

{{< edit_this_page >}}

## Что и Почему?

Считывание аргументов командной строки в Visual Basic for Applications (VBA) связано с доступом к параметрам, передаваемым в вашу программу при её выполнении. Эта техника часто используется для влияния на поведение или результаты программы без необходимости взаимодействия с пользователем, что значительно упрощает автоматизацию и создание скриптов, делая их более универсальными.

## Как:

В отличие от более простых программных сред, VBA не имеет встроенной функции для непосредственного чтения аргументов командной строки в привычном смысле, поскольку в основном предназначен для внедрения в приложения Microsoft Office. Однако, проявив немного изобретательности, мы можем использовать Windows Script Host (WSH) или вызывать внешние API для достижения аналогичной функциональности. Вот практическое решение с использованием WSH:

1. **Создайте VBScript Для Передачи Аргументов в VBA:**

   Сначала напишите файл VBScript (*yourScript.vbs*), который запускает ваше VBA-приложение (например, макрос Excel) и передает аргументы командной строки:

```vb
Set objExcel = CreateObject("Excel.Application")
objExcel.Workbooks.Open "C:\YourMacroWorkbook.xlsm"
objExcel.Run "YourMacroName", WScript.Arguments.Item(0), WScript.Arguments.Item(1)
objExcel.Quit
```

2. **Доступ к Аргументам в VBA:**

   В вашем VBA-приложении (*YourMacroWorkbook.xlsm*), измените или создайте макрос (*YourMacroName*), чтобы он принимал параметры:

```vb
Sub YourMacroName(arg1 As String, arg2 As String)
    MsgBox "Аргумент 1: " & arg1 & " Аргумент 2: " & arg2
End Sub
```

3. **Запуск Скрипта:**

   Выполните VBScript из командной строки, передавая аргументы по мере необходимости:

```shell
cscript yourScript.vbs "Привет" "Мир"
```

   Это должно привести к выполнению вашего VBA-макроса с аргументами "Привет" и "Мир", которые отображаются в сообщении.

## Глубже:

В историческом контексте VBA был разработан для расширения возможностей приложений Microsoft Office, а не как самостоятельная программная среда. Таким образом, прямое взаимодействие с командной строкой выходит за рамки его основного назначения, что объясняет отсутствие встроенной поддержки для чтения аргументов командной строки.

Указанный выше метод, хотя и эффективен, является скорее обходным решением, чем родным, использующим внешнее скриптование для преодоления пробела. Этот подход может вносить сложности и потенциальные проблемы безопасности, так как требует включения макросов и, возможно, снижения настроек безопасности для выполнения.

Для задач, сильно зависящих от аргументов командной строки или нуждающихся в более плавной интеграции с операционной системой Windows, другие языки программирования, такие как PowerShell или Python, могут предложить более надежные и безопасные решения. Эти альтернативы предоставляют прямую поддержку аргументов командной строки и лучше подходят для самостоятельных приложений или скриптов, которым требуется внешний ввод для динамического изменения их поведения.
