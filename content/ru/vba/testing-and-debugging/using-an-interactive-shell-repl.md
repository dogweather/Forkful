---
aliases:
- /ru/vba/using-an-interactive-shell-repl/
changelog:
- 2024-02-01, gpt-4-0125-preview, translated from English
date: 2024-02-01 22:04:13.687854-07:00
description: "\u0418\u043D\u0442\u0435\u0440\u0430\u043A\u0442\u0438\u0432\u043D\u0430\
  \u044F \u043E\u0431\u043E\u043B\u043E\u0447\u043A\u0430 \u0438\u043B\u0438 \u0446\
  \u0438\u043A\u043B \u0447\u0442\u0435\u043D\u0438\u044F-\u0432\u044B\u043F\u043E\
  \u043B\u043D\u0435\u043D\u0438\u044F-\u0432\u044B\u0432\u043E\u0434\u0430 (REPL)\
  \ \u043F\u043E\u0437\u0432\u043E\u043B\u044F\u0435\u0442 \u043F\u043E\u043B\u044C\
  \u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044F\u043C \u0432\u0432\u043E\u0434\u0438\
  \u0442\u044C \u043A\u043E\u043C\u0430\u043D\u0434\u044B, \u0432\u044B\u043F\u043E\
  \u043B\u043D\u044F\u0442\u044C \u0438\u0445 \u0438 \u0432\u0438\u0434\u0435\u0442\
  \u044C \u0440\u0435\u0437\u0443\u043B\u044C\u0442\u0430\u0442\u044B \u0432 \u0440\
  \u0435\u0430\u043B\u044C\u043D\u043E\u043C\u2026"
lastmod: 2024-02-18 23:08:56.789027
model: gpt-4-0125-preview
summary: "\u0418\u043D\u0442\u0435\u0440\u0430\u043A\u0442\u0438\u0432\u043D\u0430\
  \u044F \u043E\u0431\u043E\u043B\u043E\u0447\u043A\u0430 \u0438\u043B\u0438 \u0446\
  \u0438\u043A\u043B \u0447\u0442\u0435\u043D\u0438\u044F-\u0432\u044B\u043F\u043E\
  \u043B\u043D\u0435\u043D\u0438\u044F-\u0432\u044B\u0432\u043E\u0434\u0430 (REPL)\
  \ \u043F\u043E\u0437\u0432\u043E\u043B\u044F\u0435\u0442 \u043F\u043E\u043B\u044C\
  \u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044F\u043C \u0432\u0432\u043E\u0434\u0438\
  \u0442\u044C \u043A\u043E\u043C\u0430\u043D\u0434\u044B, \u0432\u044B\u043F\u043E\
  \u043B\u043D\u044F\u0442\u044C \u0438\u0445 \u0438 \u0432\u0438\u0434\u0435\u0442\
  \u044C \u0440\u0435\u0437\u0443\u043B\u044C\u0442\u0430\u0442\u044B \u0432 \u0440\
  \u0435\u0430\u043B\u044C\u043D\u043E\u043C\u2026"
title: "\u0418\u0441\u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u043D\u0438\u0435\
  \ \u0438\u043D\u0442\u0435\u0440\u0430\u043A\u0442\u0438\u0432\u043D\u043E\u0439\
  \ \u043E\u0431\u043E\u043B\u043E\u0447\u043A\u0438 (REPL)"
---

{{< edit_this_page >}}

## Что и Зачем?

Интерактивная оболочка или цикл чтения-выполнения-вывода (REPL) позволяет пользователям вводить команды, выполнять их и видеть результаты в реальном времени. Программисты используют REPL для быстрого прототипирования, тестирования фрагментов кода или отладки в более интерактивной и итеративной среде, повышая продуктивность и понимание кода.

## Как это сделать:

Visual Basic для приложений (VBA) изначально не поддерживает интерактивную оболочку или опыт работы с REPL, как это видно на примере языков, таких как Python или JavaScript. Однако вы можете в определенной степени смоделировать этот опыт, используя окно немедленного выполнения (Immediate Window) в IDE VBA (интегрированная среда разработки).

**Доступ к окну немедленного выполнения:**
1. Откройте IDE VBA, нажав `Alt + F11` в вашем приложении Office.
2. Если окно немедленного выполнения не видно, его можно открыть, нажав `Ctrl + G` или выбрав его из меню Просмотр.

**Использование окна немедленного выполнения в качестве REPL:**
- Чтобы выполнить строку кода, просто введите ее в окно немедленного выполнения и нажмите Enter. Например:

```basic
Debug.Print 2 + 2
```

- Пример вывода:
```
 4
```

- Вы также можете вызывать функции и подпрограммы, определенные в ваших модулях:

```basic
Public Sub SayHello()
    Debug.Print "Hello, World!"
End Sub
```

- А затем в окне немедленного выполнения:
```basic
Call SayHello
```

- Пример вывода:
```
 Hello, World!
```

**Заметка:** Окно немедленного выполнения имеет ограничения. Это отлично подходит для быстрых тестов и прямых вызовов функций, но не поддерживает определение функций или подпрограмм напрямую в нем. Для сложной отладки и программирования могут потребоваться полноценные разработки модулей.

## Подробнее

Окно немедленного выполнения в VBA служит ближайшим аналогом интерактивных оболочек, найденных в других программных экосистемах, несмотря на его ограничения. Исторически VBA был сосредоточен на расширении возможностей приложений Microsoft Office с помощью скриптов и макросов, а не на самостоятельной разработке программного обеспечения, что может объяснить отсутствие полноценного REPL.

Для задач, требующих обширного интерактивного тестирования или разработки сложной логики, другие программные среды, оборудованные поддержкой нативного REPL, такие как Python со своим IDLE или JavaScript с Node.js, могут предложить лучшие альтернативы. Эти среды предоставляют не только интерактивные оболочки, но и более мощные средства программирования, отладки и тестирования.

Окно немедленного выполнения предоставляет бесценный инструмент для быстрого тестирования выражений, выполнения функций и прямой манипуляции объектами приложений Office. Таким образом, оно занимает важную нишу в процессе разработки VBA, предлагая непосредственность и удобство, несравнимые с более традиционными циклами компиляции-запуска-отладки, хотя и с пониманием ограничений его операционного диапазона.
