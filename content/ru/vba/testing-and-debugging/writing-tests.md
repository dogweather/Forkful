---
aliases:
- /ru/vba/writing-tests/
changelog:
- 2024-02-01, gpt-4-0125-preview, translated from English
date: 2024-02-01 22:08:59.417804-07:00
description: "\u041D\u0430\u043F\u0438\u0441\u0430\u043D\u0438\u0435 \u0442\u0435\u0441\
  \u0442\u043E\u0432 \u0432 \u043F\u0440\u043E\u0433\u0440\u0430\u043C\u043C\u0438\
  \u0440\u043E\u0432\u0430\u043D\u0438\u0438 \u0432\u043A\u043B\u044E\u0447\u0430\u0435\
  \u0442 \u0441\u043E\u0437\u0434\u0430\u043D\u0438\u0435 \u043A\u043E\u043D\u043A\
  \u0440\u0435\u0442\u043D\u044B\u0445 \u043F\u0440\u043E\u0446\u0435\u0434\u0443\u0440\
  \ \u0434\u043B\u044F \u043F\u0440\u043E\u0432\u0435\u0440\u043A\u0438 \u0444\u0443\
  \u043D\u043A\u0446\u0438\u043E\u043D\u0430\u043B\u044C\u043D\u043E\u0441\u0442\u0438\
  \ \u0438 \u043F\u0440\u043E\u0438\u0437\u0432\u043E\u0434\u0438\u0442\u0435\u043B\
  \u044C\u043D\u043E\u0441\u0442\u0438 \u0432\u0430\u0448\u0438\u0445 \u0441\u0435\
  \u0433\u043C\u0435\u043D\u0442\u043E\u0432 \u043A\u043E\u0434\u0430, \u0447\u0442\
  \u043E\u0431\u044B\u2026"
lastmod: 2024-02-18 23:08:56.791474
model: gpt-4-0125-preview
summary: "\u041D\u0430\u043F\u0438\u0441\u0430\u043D\u0438\u0435 \u0442\u0435\u0441\
  \u0442\u043E\u0432 \u0432 \u043F\u0440\u043E\u0433\u0440\u0430\u043C\u043C\u0438\
  \u0440\u043E\u0432\u0430\u043D\u0438\u0438 \u0432\u043A\u043B\u044E\u0447\u0430\u0435\
  \u0442 \u0441\u043E\u0437\u0434\u0430\u043D\u0438\u0435 \u043A\u043E\u043D\u043A\
  \u0440\u0435\u0442\u043D\u044B\u0445 \u043F\u0440\u043E\u0446\u0435\u0434\u0443\u0440\
  \ \u0434\u043B\u044F \u043F\u0440\u043E\u0432\u0435\u0440\u043A\u0438 \u0444\u0443\
  \u043D\u043A\u0446\u0438\u043E\u043D\u0430\u043B\u044C\u043D\u043E\u0441\u0442\u0438\
  \ \u0438 \u043F\u0440\u043E\u0438\u0437\u0432\u043E\u0434\u0438\u0442\u0435\u043B\
  \u044C\u043D\u043E\u0441\u0442\u0438 \u0432\u0430\u0448\u0438\u0445 \u0441\u0435\
  \u0433\u043C\u0435\u043D\u0442\u043E\u0432 \u043A\u043E\u0434\u0430, \u0447\u0442\
  \u043E\u0431\u044B\u2026"
title: "\u041D\u0430\u043F\u0438\u0441\u0430\u043D\u0438\u0435 \u0442\u0435\u0441\u0442\
  \u043E\u0432"
---

{{< edit_this_page >}}

## Что и почему?

Написание тестов в программировании включает создание конкретных процедур для проверки функциональности и производительности ваших сегментов кода, чтобы убедиться, что они работают как ожидается в различных условиях. Программисты делают это, чтобы заранее обнаруживать ошибки, улучшать качество кода и облегчать будущее обслуживание и улучшение кода.

## Как:

Хотя Visual Basic for Applications (VBA) не поставляется с встроенной тестовой средой подобно тем, которые доступны в языках, таких как Python или JavaScript, вы все же можете реализовать простые тестовые процедуры для проверки целостности вашего кода. Вот пример для иллюстрации:

Предположим, у вас есть функция в VBA, которая складывает два числа:

```basic
Function AddNumbers(x As Integer, y As Integer) As Integer
    AddNumbers = x + y
End Function
```

Для тестирования этой функции вы можете написать другую процедуру, которая проверяет ее вывод на соответствие ожидаемым результатам:

```basic
Sub TestAddNumbers()
    Dim result As Integer
    result = AddNumbers(5, 10)
    If result = 15 Then
        MsgBox "Тест пройден!", vbInformation
    Else
        MsgBox "Тест не пройден. Ожидалось 15, получено " & result, vbCritical
    End If
End Sub
```

Выполнение `TestAddNumbers` отобразит сообщение, указывающее, пройден тест или нет, на основании вывода функции. Хотя это упрощенный сценарий, вы можете создавать более сложные тесты, включая циклы, различные входные значения и тестирование нескольких функций.

## Погружение в тему

Показанный здесь подход к написанию тестов в VBA является ручным и лишен функциональности более сложных тестовых сред, доступных в других средах программирования, таких как автоматические запуски тестов, процедуры установки/завершения и интегрированная отчетность по результатам тестов. До широкого распространения фреймворков модульного тестирования и разработки, управляемой тестами (TDD), ручные тестовые процедуры, подобные описанной, были распространены. Хотя этот метод прост и может быть эффективным для небольших проектов или в учебных целях, он не масштабируем или эффективен для крупных проектов или команд.

В средах, поддерживающих более богатые наборы инструментов разработки, программисты часто обращаются к таким фреймворкам, как NUnit для приложений .NET или JUnit для приложений Java, которые предоставляют комплексные инструменты для систематического написания и выполнения тестов. Эти фреймворки предлагают продвинутые функции, такие как утверждение результатов тестов, настройка макетов объектов и измерение покрытия кода.

Для разработчиков VBA, ищущих более продвинутые возможности тестирования, ближайшей альтернативой могло бы быть использование внешних инструментов или интеграция с другими средами программирования. Некоторые разработчики используют VBA в сочетании с Excel для ручной записи тестовых сценариев и результатов. Хотя это не так удобно или автоматизировано, как использование специализированной тестовой среды, эти методы могут частично восполнить пробел, помогая поддерживать надежность решений на VBA в сложных или критически важных приложениях.
