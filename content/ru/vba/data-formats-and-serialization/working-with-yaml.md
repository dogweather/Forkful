---
aliases:
- /ru/vba/working-with-yaml/
changelog:
- 2024-02-01, gpt-4-0125-preview, translated from English
date: 2024-02-01 22:07:43.331064-07:00
description: "YAML, \u0447\u0442\u043E \u0440\u0430\u0441\u0448\u0438\u0444\u0440\u043E\
  \u0432\u044B\u0432\u0430\u0435\u0442\u0441\u044F \u043A\u0430\u043A \"YAML Ain't\
  \ Markup Language\" (YAML - \u044D\u0442\u043E \u043D\u0435 \u044F\u0437\u044B\u043A\
  \ \u0440\u0430\u0437\u043C\u0435\u0442\u043A\u0438), - \u044D\u0442\u043E \u044F\
  \u0437\u044B\u043A \u0441\u0435\u0440\u0438\u0430\u043B\u0438\u0437\u0430\u0446\u0438\
  \u0438 \u0434\u0430\u043D\u043D\u044B\u0445, \u043F\u043E\u043D\u044F\u0442\u043D\
  \u044B\u0445 \u0447\u0435\u043B\u043E\u0432\u0435\u043A\u0443, \u0447\u0430\u0441\
  \u0442\u043E\u2026"
lastmod: 2024-02-18 23:08:56.811901
model: gpt-4-0125-preview
summary: "YAML, \u0447\u0442\u043E \u0440\u0430\u0441\u0448\u0438\u0444\u0440\u043E\
  \u0432\u044B\u0432\u0430\u0435\u0442\u0441\u044F \u043A\u0430\u043A \"YAML Ain't\
  \ Markup Language\" (YAML - \u044D\u0442\u043E \u043D\u0435 \u044F\u0437\u044B\u043A\
  \ \u0440\u0430\u0437\u043C\u0435\u0442\u043A\u0438), - \u044D\u0442\u043E \u044F\
  \u0437\u044B\u043A \u0441\u0435\u0440\u0438\u0430\u043B\u0438\u0437\u0430\u0446\u0438\
  \u0438 \u0434\u0430\u043D\u043D\u044B\u0445, \u043F\u043E\u043D\u044F\u0442\u043D\
  \u044B\u0445 \u0447\u0435\u043B\u043E\u0432\u0435\u043A\u0443, \u0447\u0430\u0441\
  \u0442\u043E\u2026"
title: "\u0420\u0430\u0431\u043E\u0442\u0430 \u0441 YAML"
---

{{< edit_this_page >}}

## Что и Почему?

YAML, что расшифровывается как "YAML Ain't Markup Language" (YAML - это не язык разметки), - это язык сериализации данных, понятных человеку, часто используемый для файлов конфигурации. Программисты часто используют его из-за его простоты и читаемости в множестве программных сред, включая скриптовую среду Visual Basic for Applications (VBA), чтобы повысить взаимодействие, а также хранение и обмен данными.

## Как это сделать:

Работа с YAML в VBA требует понимания того, как разобрать и преобразовать YAML в формат, который VBA может легко манипулировать, обычно это словари или коллекции. К сожалению, VBA нативно не поддерживает разбор или сериализацию YAML. Однако, можно использовать комбинацию инструментов конвертации JSON и объектов словаря для работы с данными YAML, учитывая близкое родство YAML с JSON.

Сначала преобразуйте ваши данные YAML в JSON с помощью онлайн конвертера или инструмента преобразования YAML в JSON в вашей среде разработки. После преобразования вы можете использовать следующий пример для разбора JSON в VBA, отмечая, что этот подход косвенно позволяет вам работать с YAML:

```vb
' Добавьте ссылку на Microsoft Scripting Runtime для Dictionary
' Добавьте ссылку на Microsoft XML, v6.0 для разбора JSON

Sub ParseYAMLAsJSON()
    Dim jsonText As String
    jsonText = "{""name"": ""John Doe"", ""age"": 30}" ' Это JSON, преобразованный из YAML
    
    ' Предполагая, что у вас есть функция разбора JSON
    Dim parsedData As Dictionary
    Set parsedData = JsonParser(jsonText)
    
    Debug.Print "Имя: " & parsedData("name")
    Debug.Print "Возраст: " & parsedData("age")
End Sub

Function JsonParser(ByVal jsonText As String) As Dictionary
    ' Заглушка для логики разбора JSON - здесь вы можете использовать внешнюю библиотеку
    Set JsonParser = New Dictionary
    JsonParser.Add "name", "John Doe"
    JsonParser.Add "age", 30
End Function
```
В этом примере функция `JsonParser` является альтернативой для места, где вы бы разбирали JSON. Для помощи в разборе JSON доступно множество библиотек, поскольку непосредственные библиотеки разбора YAML для VBA редки.

## Глубокое погружение

Отсутствие прямой работы с YAML в VBA можно объяснить его возрастом и средой, для которой он был создан, которая изначально не была предназначена для современных форматов сериализации данных. YAML сам по себе стал популярным форматом конфигурации и сериализации в начале 2000-х годов, что совпало с появлением приложений, требующих более понятных для человека файлов конфигурации.

Программисты обычно используют внешние инструменты или библиотеки для связи между VBA и YAML. Это часто влечет за собой преобразование YAML в JSON, как показано выше, из-за доступной поддержки JSON через различные библиотеки и схожести между JSON и YAML с точки зрения структуры и назначения.

Хотя работа с YAML напрямую в VBA демонстрирует гибкость языка, стоит отметить, что другие программные среды (например, Python или JavaScript) обеспечивают более нативную и беспроблемную поддержку YAML. Эти альтернативы могут быть более подходящими для проектов, которые в значительной степени зависят от YAML для конфигурации или сериализации данных. Тем не менее, для тех, кто предан VBA или требует его использования, косвенный метод через преобразование JSON остается жизнеспособным и полезным подходом к управлению и манипулированию данными YAML.
