---
changelog:
- 2024-02-01, gpt-4-0125-preview, translated from English
date: 2024-02-01 22:06:38.275266-07:00
description: "TOML, \u0447\u0442\u043E \u043E\u0437\u043D\u0430\u0447\u0430\u0435\u0442\
  \ \"\u042F\u0441\u043D\u044B\u0439, \u041C\u0438\u043D\u0438\u043C\u0430\u043B\u044C\
  \u043D\u044B\u0439 \u042F\u0437\u044B\u043A \u0422\u043E\u043C\u0430\", \u043F\u0440\
  \u0435\u0434\u0441\u0442\u0430\u0432\u043B\u044F\u0435\u0442 \u0441\u043E\u0431\u043E\
  \u0439 \u0444\u043E\u0440\u043C\u0430\u0442 \u0441\u0435\u0440\u0438\u0430\u043B\
  \u0438\u0437\u0430\u0446\u0438\u0438 \u0434\u0430\u043D\u043D\u044B\u0445, \u0432\
  \ \u043E\u0441\u043D\u043E\u0432\u043D\u043E\u043C \u0438\u0441\u043F\u043E\u043B\
  \u044C\u0437\u0443\u0435\u043C\u044B\u0439 \u0434\u043B\u044F \u0444\u0430\u0439\
  \u043B\u043E\u0432 \u043A\u043E\u043D\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\
  \u0438.\u2026"
lastmod: '2024-03-13T22:44:44.784923-06:00'
model: gpt-4-0125-preview
summary: "TOML, \u0447\u0442\u043E \u043E\u0437\u043D\u0430\u0447\u0430\u0435\u0442\
  \ \"\u042F\u0441\u043D\u044B\u0439, \u041C\u0438\u043D\u0438\u043C\u0430\u043B\u044C\
  \u043D\u044B\u0439 \u042F\u0437\u044B\u043A \u0422\u043E\u043C\u0430\", \u043F\u0440\
  \u0435\u0434\u0441\u0442\u0430\u0432\u043B\u044F\u0435\u0442 \u0441\u043E\u0431\u043E\
  \u0439 \u0444\u043E\u0440\u043C\u0430\u0442 \u0441\u0435\u0440\u0438\u0430\u043B\
  \u0438\u0437\u0430\u0446\u0438\u0438 \u0434\u0430\u043D\u043D\u044B\u0445, \u0432\
  \ \u043E\u0441\u043D\u043E\u0432\u043D\u043E\u043C \u0438\u0441\u043F\u043E\u043B\
  \u044C\u0437\u0443\u0435\u043C\u044B\u0439 \u0434\u043B\u044F \u0444\u0430\u0439\
  \u043B\u043E\u0432 \u043A\u043E\u043D\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\
  \u0438."
title: "\u0420\u0430\u0431\u043E\u0442\u0430 \u0441 TOML"
weight: 39
---

## Как это сделать:
Работа с TOML в VBA включает разбор файла TOML для чтения конфигураций или настроек в ваш проект VBA. VBA не имеет встроенной поддержки для TOML, поэтому обычно используется парсер или преобразование данных TOML в формат, с которым VBA может легко работать, например, JSON или XML. Вот как вручную разобрать простой конфигурационный файл TOML:

1. **Пример файла TOML** (`config.toml`):
```
title = "Пример TOML"

[database]
server = "192.168.1.1"
ports = [ 8000, 8001, 8002 ]
connection_max = 5000
enabled = true
```

2. **Код VBA для разбора TOML**:

Предполагая, что содержимое TOML считано в строковую переменную `tomlStr`, следующий код VBA демонстрирует упрощенный подход к разбору секции `[database]`:

```vb
Function ParseTOML(tomlStr As String)
    Dim lines() As String
    lines = Split(tomlStr, vbCrLf)
    
    Dim config As Object
    Set config = CreateObject("Scripting.Dictionary")
    Dim currentSection As String
    currentSection = ""
    
    Dim i As Integer
    For i = 0 To UBound(lines)
        Dim line As String
        line = Trim(lines(i))
        If InStr(line, "[") > 0 And InStr(line, "]") > 0 Then
            currentSection = Mid(line, 2, Len(line) - 2)
            Set config(currentSection) = CreateObject("Scripting.Dictionary")
        ElseIf InStr(line, "=") > 0 Then
            Dim parts() As String
            parts = Split(line, "=")
            Dim key As String
            key = Trim(parts(0))
            Dim value As String
            value = Trim(parts(1))
            config(currentSection)(key) = value
        End If
    Next i
    
    'Пример доступа к разобранным данным
    Debug.Print "Сервер базы данных: "; config("database")("server")
End Function
```

3. **Пример вывода** (окно немедленных сообщений):
```
Сервер базы данных: 192.168.1.1
```

## Глубокое погружение
Практическое признание TOML в сообществе разработчиков демонстрирует тенденцию к более простым, понятным для человека файлам конфигурации, что контрастирует с ранее распространенными XML. Философия проектирования TOML акцентирует внимание на четких семантиках и стремится к простому разбору с минимальными накладными расходами. В VBA прямая работа с TOML включает в себя ручной разбор или использование внешних инструментов для преобразования TOML в более подходящий для VBA формат из-за отсутствия встроенной поддержки. Хотя этот метод ручного разбора демонстрирует основной подход, использование внешних библиотек или промежуточных форматов, таких как JSON, может предложить более надежные и устойчивые к ошибкам стратегии разбора. Учитывая широкую интеграцию VBA с Microsoft Office, преобразование TOML в JSON и использование встроенных возможностей VBA для разбора JSON (где это применимо) или сторонних парсеров JSON могут обеспечить более эффективный рабочий процесс. Кроме того, с постоянным развитием форматов сериализации данных, программистам также следует рассмотреть YAML, который, подобно TOML, акцентирует внимание на читаемости для человека, но предлагает разные компромиссы с точки зрения сложности и гибкости.
