---
aliases:
- /ru/vba/generating-random-numbers/
changelog:
- 2024-02-01, gpt-4-0125-preview, translated from English
date: 2024-02-01 21:54:37.603847-07:00
description: "\u0413\u0435\u043D\u0435\u0440\u0430\u0446\u0438\u044F \u0441\u043B\u0443\
  \u0447\u0430\u0439\u043D\u044B\u0445 \u0447\u0438\u0441\u0435\u043B \u0432 Visual\
  \ Basic for Applications (VBA) \u043F\u043E\u0437\u0432\u043E\u043B\u044F\u0435\u0442\
  \ \u043F\u0440\u043E\u0433\u0440\u0430\u043C\u043C\u0430\u043C \u0438\u043C\u0438\
  \u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u043F\u0440\u043E\u0446\u0435\u0441\
  \u0441\u044B \u0441 \u044D\u043B\u0435\u043C\u0435\u043D\u0442\u0430\u043C\u0438\
  \ \u0441\u043B\u0443\u0447\u0430\u0439\u043D\u043E\u0441\u0442\u0438 \u0438\u043B\
  \u0438 \u043F\u0435\u0440\u0435\u043C\u0435\u043D\u0447\u0438\u0432\u043E\u0441\u0442\
  \u0438,\u2026"
lastmod: 2024-02-18 23:08:56.781665
model: gpt-4-0125-preview
summary: "\u0413\u0435\u043D\u0435\u0440\u0430\u0446\u0438\u044F \u0441\u043B\u0443\
  \u0447\u0430\u0439\u043D\u044B\u0445 \u0447\u0438\u0441\u0435\u043B \u0432 Visual\
  \ Basic for Applications (VBA) \u043F\u043E\u0437\u0432\u043E\u043B\u044F\u0435\u0442\
  \ \u043F\u0440\u043E\u0433\u0440\u0430\u043C\u043C\u0430\u043C \u0438\u043C\u0438\
  \u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u043F\u0440\u043E\u0446\u0435\u0441\
  \u0441\u044B \u0441 \u044D\u043B\u0435\u043C\u0435\u043D\u0442\u0430\u043C\u0438\
  \ \u0441\u043B\u0443\u0447\u0430\u0439\u043D\u043E\u0441\u0442\u0438 \u0438\u043B\
  \u0438 \u043F\u0435\u0440\u0435\u043C\u0435\u043D\u0447\u0438\u0432\u043E\u0441\u0442\
  \u0438,\u2026"
title: "\u0413\u0435\u043D\u0435\u0440\u0430\u0446\u0438\u044F \u0441\u043B\u0443\u0447\
  \u0430\u0439\u043D\u044B\u0445 \u0447\u0438\u0441\u0435\u043B"
---

{{< edit_this_page >}}

## Что и почему?

Генерация случайных чисел в Visual Basic for Applications (VBA) позволяет программам имитировать процессы с элементами случайности или переменчивости, такие как броски костей или выборка данных. Программисты используют эти техники для разработки моделей, игр или симуляций, где предсказуемые результаты были бы нереалистичными или менее полезными.

## Как это сделать:

В VBA функция `Rnd` используется для генерации случайных чисел. По умолчанию `Rnd` генерирует число с плавающей запятой одинарной точности, большее или равное 0 и меньшее 1. Вот несколько шагов и примеров для эффективного использования случайных чисел:

1. **Простое случайное число:**
   Чтобы сгенерировать базовое случайное число, вам просто нужно вызвать `Rnd()`:

   ```vb
   Sub GenerateRandomNumber()
       Dim randomNumber As Single
       randomNumber = Rnd() ' Случайное число между 0 и 1
       MsgBox randomNumber
   End Sub
   ```

2. **Установка начального значения:**
   Оператор `Randomize` инициализирует генератор случайных чисел, что может быть критически важно для обеспечения разных результатов каждый раз, когда ваш VBA код выполняется:

   ```vb
   Sub SeedRandomNumber()
       Randomize
       Dim randomNumber As Single
       randomNumber = Rnd()
       MsgBox randomNumber
   End Sub
   ```

3. **Генерация чисел в диапазоне:**
   Часто вам может потребоваться случайное число в определенном диапазоне. Вот как сгенерировать число между 1 и 100:

   ```vb
   Sub RandomNumberInRange()
       Randomize
       Dim randomNumber As Integer
       randomNumber = Int((100 * Rnd()) + 1) ' Случайное число между 1 и 100
       MsgBox randomNumber
   End Sub
   ```

### Пример вывода:
После выполнения `RandomNumberInRange`, в сообщении может отобразиться число, например, `45`.

## Углубленный разбор:

Функция `Rnd` в VBA, хотя и легка в использовании, на самом деле генерирует псевдослучайные числа на основе детерминированного алгоритма. Это означает, что последовательности чисел, которые она производит, не являются по-настоящему случайными, но часто могут быть достаточными для выполнения общих задач, требующих стохастических процессов.

Исторически, способность генерации случайных чисел в VBA восходит к ранним версиям Basic, адаптируясь со временем для включения функций вроде `Randomize` для улучшения случайности за счет инициализации алгоритма с начальной точки. Однако для приложений, требующих высокого уровня случайности, таких как безопасные криптографические операции, `Rnd` в VBA может не быть лучшим инструментом. Следует рассмотреть альтернативы в более надежных программных средах или языках, разработанных с учетом криптографии, например, модуль `secrets` в Python или `SecureRandom` в Java.

Несмотря на свои ограничения, простота и доступность генерации случайных чисел в VBA продолжают делать ее ценным инструментом для широкого круга более легких приложений, работ по симуляции и образовательных целей.
