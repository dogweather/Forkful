---
aliases:
- /ru/vba/working-with-complex-numbers/
changelog:
- 2024-02-01, gpt-4-0125-preview, translated from English
date: 2024-02-01 22:08:17.396351-07:00
description: "\u0420\u0430\u0431\u043E\u0442\u0430 \u0441 \u043A\u043E\u043C\u043F\
  \u043B\u0435\u043A\u0441\u043D\u044B\u043C\u0438 \u0447\u0438\u0441\u043B\u0430\u043C\
  \u0438 \u0432\u043A\u043B\u044E\u0447\u0430\u0435\u0442 \u0432\u044B\u043F\u043E\
  \u043B\u043D\u0435\u043D\u0438\u0435 \u043C\u0430\u0442\u0435\u043C\u0430\u0442\u0438\
  \u0447\u0435\u0441\u043A\u0438\u0445 \u043E\u043F\u0435\u0440\u0430\u0446\u0438\u0439\
  \ \u0441 \u0447\u0438\u0441\u043B\u0430\u043C\u0438, \u0438\u043C\u0435\u044E\u0449\
  \u0438\u043C\u0438 \u043A\u0430\u043A \u0434\u0435\u0439\u0441\u0442\u0432\u0438\
  \u0442\u0435\u043B\u044C\u043D\u0443\u044E, \u0442\u0430\u043A \u0438 \u043C\u043D\
  \u0438\u043C\u0443\u044E \u0447\u0430\u0441\u0442\u044C. \u041F\u0440\u043E\u0433\
  \u0440\u0430\u043C\u043C\u0438\u0441\u0442\u044B \u0447\u0430\u0441\u0442\u043E\u2026"
lastmod: 2024-02-18 23:08:56.779269
model: gpt-4-0125-preview
summary: "\u0420\u0430\u0431\u043E\u0442\u0430 \u0441 \u043A\u043E\u043C\u043F\u043B\
  \u0435\u043A\u0441\u043D\u044B\u043C\u0438 \u0447\u0438\u0441\u043B\u0430\u043C\u0438\
  \ \u0432\u043A\u043B\u044E\u0447\u0430\u0435\u0442 \u0432\u044B\u043F\u043E\u043B\
  \u043D\u0435\u043D\u0438\u0435 \u043C\u0430\u0442\u0435\u043C\u0430\u0442\u0438\u0447\
  \u0435\u0441\u043A\u0438\u0445 \u043E\u043F\u0435\u0440\u0430\u0446\u0438\u0439\
  \ \u0441 \u0447\u0438\u0441\u043B\u0430\u043C\u0438, \u0438\u043C\u0435\u044E\u0449\
  \u0438\u043C\u0438 \u043A\u0430\u043A \u0434\u0435\u0439\u0441\u0442\u0432\u0438\
  \u0442\u0435\u043B\u044C\u043D\u0443\u044E, \u0442\u0430\u043A \u0438 \u043C\u043D\
  \u0438\u043C\u0443\u044E \u0447\u0430\u0441\u0442\u044C. \u041F\u0440\u043E\u0433\
  \u0440\u0430\u043C\u043C\u0438\u0441\u0442\u044B \u0447\u0430\u0441\u0442\u043E\u2026"
title: "\u0420\u0430\u0431\u043E\u0442\u0430 \u0441 \u043A\u043E\u043C\u043F\u043B\
  \u0435\u043A\u0441\u043D\u044B\u043C\u0438 \u0447\u0438\u0441\u043B\u0430\u043C\u0438"
---

{{< edit_this_page >}}

## Что и почему?

Работа с комплексными числами включает выполнение математических операций с числами, имеющими как действительную, так и мнимую часть. Программисты часто сталкиваются с комплексными числами в таких областях, как инженерия, физика и везде, где задействовано решение уравнений, которые невозможно решить только с действительными числами.

## Как:

В Visual Basic для приложений (VBA) работа с комплексными числами может быть менее очевидной по сравнению с языками, имеющими встроенную поддержку их. Тем не менее, вы можете управлять комплексными операциями, создавая функции или используя существующие функции библиотеки. Давайте рассмотрим простой пример сложения, вычитания, умножения и деления комплексных чисел:

```vb
' Функция для сложения комплексных чисел
Function AddComplex(x As String, y As String) As String
    Dim real1 As Double, imag1 As Double
    Dim real2 As Double, imag2 As Double
    
    ' Извлечение действительной и мнимой частей из комплексных чисел
    real1 = Val(Split(x, "+")(0))
    imag1 = Val(Split(x, "+")(1))
    real2 = Val(Split(y, "+")(0))
    imag2 = Val(Split(y, "+")(1))
    
    ' Выполнение сложения
    AddComplex = (real1 + real2) & "+" & (imag1 + imag2) & "i"
End Function

' Пример использования
Sub ExampleUsage()
    Dim result As String
    result = AddComplex("3+2i", "1+7i")
    Debug.Print "Результат сложения: " & result  ' Вывод: Результат сложения: 4+9i
End Sub
```

Хотя это демонстрирует сложение, аналогичные подходы могут быть адаптированы для вычитания, умножения и деления. Для комплексных операций, выходящих за рамки базовой арифметики, может быть целесообразно изучить внешние библиотеки или интегрировать другие решения, которые поддерживают операции с комплексными числами более нативно.

## Глубокое погружение:

VBA не включает встроенную поддержку комплексных чисел, аспект, в котором она отстает от таких языков, как Python, имеющий класс комплексных чисел (`complex`), или C++ со своей Стандартной Библиотекой Шаблонов (`std::complex`). Исторически, необходимость прямого манипулирования комплексными числами в VBA довольно редка, поскольку он часто используется для автоматизации, управления приложениями Office и задач, которые традиционно не требуют сложных математических расчетов. При разработке и создании VBA его основные применения были сосредоточены в основном на бизнес-приложениях, а не на научных вычислениях, что может объяснить это упущение.

Для задач, требующих обширных манипуляций с комплексными числами, программистам может быть полезно использование более математически ориентированного языка. Однако для тех, кто привержен или ограничен использованием VBA, написание пользовательских функций (как показано) или интеграция с программным обеспечением, имеющим эти возможности (например, MATLAB или сам Excel до некоторой степени), являются возможными путями. Несмотря на свои ограничения, творческие решения и внешние интеграции могут расширить функциональность VBA в области, для которых он изначально не предназначался, включая работу с комплексными числами.
