---
title:                "Округление чисел"
date:                  2024-02-01T22:01:16.209613-07:00
model:                 gpt-4-0125-preview
simple_title:         "Округление чисел"
tag:                  "Numbers"
editURL:              "https://github.com/dogweather/forkful/blob/master/content/ru/vba/rounding-numbers.md"
changelog:
  - 2024-02-01, gpt-4-0125-preview, translated from English
---

{{< edit_this_page >}}

## Что и Почему?

Округление чисел в программировании связано с приближением числа к ближайшему целому числу или к определенному количеству десятичных знаков. Программисты округляют числа для упрощения фигур, улучшения читаемости или для выполнения конкретных числовых критериев в расчетах, особенно в финансовых вычислениях, где точность имеет значение.

## Как:

В Visual Basic for Applications (VBA) для округления можно использовать несколько функций, каждая из которых подходит для конкретных сценариев. Вот наиболее часто используемые функции с примерами:

1. **Функция Round**:
   Функция `Round` округляет число до указанного количества цифр.
   ```basic
   Dim roundedNumber As Double
   roundedNumber = Round(3.14159, 2)  ' Вывод: 3.14
   MsgBox roundedNumber
   ```
   
2. **Функции Int и Fix**:
   Функции `Int` и `Fix` используются для округления чисел в меньшую сторону до ближайшего целого, но они по-разному ведут себя с отрицательными числами.
   ```basic
   Dim intRounded As Integer
   Dim fixRounded As Integer
   
   intRounded = Int(-3.14159)  ' Вывод: -4
   fixRounded = Fix(-3.14159)  ' Вывод: -3
   
   MsgBox "Int: " & intRounded & ", Fix: " & fixRounded
   ```

3. **Функции Ceiling и Floor**:
   В VBA нет встроенных функций `Ceiling` и `Floor`, которые есть в других языках. Для имитации используйте `Application.WorksheetFunction.Ceiling_Math` и `Application.WorksheetFunction.Floor_Math` для Excel VBA.
   ```basic
   Dim ceilingNumber As Double
   Dim floorNumber As Double
   
   ceilingNumber = Application.WorksheetFunction.Ceiling_Math(3.14159)  ' Вывод: 4
   floorNumber = Application.WorksheetFunction.Floor_Math(3.14159)  ' Вывод: 3
   
   MsgBox "Ceiling: " & ceilingNumber & ", Floor: " & floorNumber
   ```

## Глубокое погружение

Функция `Round` в VBA принципиально отличается от методов округления в других языках из-за использования **Банковского округления**. Банковское округление осуществляется до ближайшего четного числа, когда значение находится ровно посередине между двумя числами, что снижает предвзятость в вычислениях на большом наборе данных и обеспечивает более статистически значимый результат. Однако это может привести к неожиданному поведению для тех, кто не знаком с ним, особенно когда в каждом случае ожидается точность до целых чисел.

В отличие от многих языков программирования и систем, использующих "арифметическое округление" или "округление к ближайшему большему", где число, точно находящееся посередине между двумя возможными округленными значениями, всегда округляется в большую сторону. При переводе или переносе кода с других языков на VBA программисты должны учитывать эти различия, чтобы избежать тонких ошибок или неточностей в финансовых и статистических приложениях.

Хотя VBA предлагает разнообразие функций для округления, отсутствие функций `Ceiling` и `Floor` (без использования WorksheetFunction Excel) подчеркивает ограничение в его встроенных возможностях. Программистам, пришедшим из более функционально насыщенных языков, эти пробелы могут показаться неудобными и может потребоваться реализация собственных решений или адаптация их расчетов для использования доступных функций. Несмотря на эти ограничения, правильное понимание и использование функций округления в VBA могут помочь обеспечить точность численных вычислений и соответствие требованиям большинства приложений.
