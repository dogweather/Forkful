---
aliases:
- /uk/rust/refactoring/
date: 2024-01-26 03:37:56.291616-07:00
description: "\u0420\u0435\u0444\u0430\u043A\u0442\u043E\u0440\u0438\u043D\u0433 \u2014\
  \ \u0446\u0435 \u043F\u0440\u043E\u0446\u0435\u0441 \u0440\u0435\u0441\u0442\u0440\
  \u0443\u043A\u0442\u0443\u0440\u0438\u0437\u0430\u0446\u0456\u0457 \u0456\u0441\u043D\
  \u0443\u044E\u0447\u043E\u0433\u043E \u043A\u043E\u043C\u043F\u2019\u044E\u0442\u0435\
  \u0440\u043D\u043E\u0433\u043E \u043A\u043E\u0434\u0443 \u2014 \u0437\u043C\u0456\
  \u043D\u0438 \u0444\u0430\u043A\u0442\u043E\u0440\u0438\u043D\u0433\u0443 \u2014\
  \ \u0431\u0435\u0437 \u0437\u043C\u0456\u043D\u0438 \u0439\u043E\u0433\u043E \u0437\
  \u043E\u0432\u043D\u0456\u0448\u043D\u044C\u043E\u0457 \u043F\u043E\u0432\u0435\u0434\
  \u0456\u043D\u043A\u0438. \u041F\u0440\u043E\u0433\u0440\u0430\u043C\u0456\u0441\
  \u0442\u0438 \u0440\u043E\u0431\u043B\u044F\u0442\u044C \u0446\u0435 \u0434\u043B\
  \u044F\u2026"
lastmod: 2024-02-18 23:08:59.986841
model: gpt-4-0125-preview
summary: "\u0420\u0435\u0444\u0430\u043A\u0442\u043E\u0440\u0438\u043D\u0433 \u2014\
  \ \u0446\u0435 \u043F\u0440\u043E\u0446\u0435\u0441 \u0440\u0435\u0441\u0442\u0440\
  \u0443\u043A\u0442\u0443\u0440\u0438\u0437\u0430\u0446\u0456\u0457 \u0456\u0441\u043D\
  \u0443\u044E\u0447\u043E\u0433\u043E \u043A\u043E\u043C\u043F\u2019\u044E\u0442\u0435\
  \u0440\u043D\u043E\u0433\u043E \u043A\u043E\u0434\u0443 \u2014 \u0437\u043C\u0456\
  \u043D\u0438 \u0444\u0430\u043A\u0442\u043E\u0440\u0438\u043D\u0433\u0443 \u2014\
  \ \u0431\u0435\u0437 \u0437\u043C\u0456\u043D\u0438 \u0439\u043E\u0433\u043E \u0437\
  \u043E\u0432\u043D\u0456\u0448\u043D\u044C\u043E\u0457 \u043F\u043E\u0432\u0435\u0434\
  \u0456\u043D\u043A\u0438. \u041F\u0440\u043E\u0433\u0440\u0430\u043C\u0456\u0441\
  \u0442\u0438 \u0440\u043E\u0431\u043B\u044F\u0442\u044C \u0446\u0435 \u0434\u043B\
  \u044F\u2026"
title: "\u0420\u0435\u0444\u0430\u043A\u0442\u043E\u0440\u0438\u043D\u0433"
---

{{< edit_this_page >}}

## Що і Чому?

Рефакторинг — це процес реструктуризації існуючого комп’ютерного коду — зміни факторингу — без зміни його зовнішньої поведінки. Програмісти роблять це для покращення нефункціональних атрибутів програмного забезпечення, таких як читабельність, зниження складності, покращення підтримки, та створення більш виразної внутрішньої архітектури або об’єктної моделі для покращення розширюваності.

## Як це зробити:

Давайте рефакторити простий шматок коду на Rust, щоб зробити його більш ідіоматичним та легшим для підтримки. Ми починаємо з функції, яка обчислює суму вектора цілих чисел:

```rust
fn sum(vec: &Vec<i32>) -> i32 {
    let mut sum = 0;
    for i in vec {
        sum += i;
    }
    sum
}

fn main() {
    let numbers = vec![1, 2, 3, 4, 5];
    println!("Сума {}", sum(&numbers));
}
```

Вивід:
```
Сума 15
```

Тепер давайте рефакторити це, використовуючи більш ідіоматичний Rust за допомогою ітераторів та методу `fold`:

```rust
fn sum(vec: &[i32]) -> i32 {
    vec.iter().fold(0, |acc, &x| acc + x)
}

fn main() {
    let numbers = vec![1, 2, 3, 4, 5];
    println!("Сума {}", sum(&numbers));
}
```

Зміни в виводі немає — все ще `15` — але рефакторена версія чистіша та використовує сили Rust, такі як запозичення та методи ітераторів.

## Поглиблений огляд

Рефакторинг має свої корені в спільноті Smalltalk та був популяризований у світі Java книгою Мартіна Фаулера "Рефакторинг: Покращення дизайну існуючого коду". Його принципи є універсальними та застосовні до Rust також, де безпека та одночасність є найважливішими. Rust спонукає писати надійний код, виявляючи проблеми на етапі компіляції, таким чином, під час рефакторингу, компілятор Rust виступає як сітка безпеки.

Альтернативами ручному рефакторингу є використання автоматизованих інструментів, таких як 'rustfmt' для форматування коду та 'clippy' для лінтингу, які можуть запропонувати більш ідіоматичні способи написання коду. Однак, глибокий рефакторинг часто вимагає обдуманого розуміння дизайну коду, яке ці інструменти не можуть повністю автоматизувати.

У Rust рефакторинг може стосуватися покращення використання типів, ефективного використання тривалостей життя, зниження непотрібних виділень пам'яті або використання шаблонів одночасності, як от використання `Arc<Mutex<T>>` коли це необхідно. Також поширеною практикою є перехід від `unwrap()` до більш виразного оброблення помилок із `Result<T, E>`.

## Дивіться також

Щоб глибше зануритися в рефакторинг на Rust:

- Книга Rust: https://doc.rust-lang.org/book/
- Rust на прикладах: https://doc.rust-lang.org/rust-by-example/
- Clippy, інструмент для лінтингу Rust: https://github.com/rust-lang/rust-clippy
- "Рефакторинг: Покращення дизайну існуючого коду" Мартіна Фаулера: https://martinfowler.com/books/refactoring.html
