---
aliases:
- /uk/vba/working-with-xml/
changelog:
- 2024-02-01, gpt-4-0125-preview, translated from English
date: 2024-02-01 22:07:17.864344-07:00
description: "\u0420\u043E\u0431\u043E\u0442\u0430 \u0437 XML \u0443 Visual Basic\
  \ for Applications (VBA) \u0432\u043A\u043B\u044E\u0447\u0430\u0454 \u0430\u043D\
  \u0430\u043B\u0456\u0437, \u0441\u0442\u0432\u043E\u0440\u0435\u043D\u043D\u044F\
  \ \u0442\u0430 \u043C\u043E\u0434\u0438\u0444\u0456\u043A\u0430\u0446\u0456\u044E\
  \ XML-\u0434\u043E\u043A\u0443\u043C\u0435\u043D\u0442\u0456\u0432 \u0443 \u043A\
  \u043E\u043D\u0442\u0435\u043A\u0441\u0442\u0456 \u0437\u0430\u0441\u0442\u043E\u0441\
  \u0443\u043D\u043A\u0456\u0432 Microsoft Office.\u2026"
lastmod: 2024-02-18 23:09:00.089213
model: gpt-4-0125-preview
summary: "\u0420\u043E\u0431\u043E\u0442\u0430 \u0437 XML \u0443 Visual Basic for\
  \ Applications (VBA) \u0432\u043A\u043B\u044E\u0447\u0430\u0454 \u0430\u043D\u0430\
  \u043B\u0456\u0437, \u0441\u0442\u0432\u043E\u0440\u0435\u043D\u043D\u044F \u0442\
  \u0430 \u043C\u043E\u0434\u0438\u0444\u0456\u043A\u0430\u0446\u0456\u044E XML-\u0434\
  \u043E\u043A\u0443\u043C\u0435\u043D\u0442\u0456\u0432 \u0443 \u043A\u043E\u043D\
  \u0442\u0435\u043A\u0441\u0442\u0456 \u0437\u0430\u0441\u0442\u043E\u0441\u0443\u043D\
  \u043A\u0456\u0432 Microsoft Office.\u2026"
title: "\u0420\u043E\u0431\u043E\u0442\u0430 \u0437 XML"
---

{{< edit_this_page >}}

## Що та чому?

Робота з XML у Visual Basic for Applications (VBA) включає аналіз, створення та модифікацію XML-документів у контексті застосунків Microsoft Office. Програмісти звертаються до цієї можливості для інтеграції застосунків Office з веб-службами чи іншими джерелами даних, які генерують XML, сприяючи обміну даними та функціональності звітності.

## Як це зробити:

Для початку взаємодії з XML зазвичай використовується об'єкт `MSXML2.DOMDocument`. Цей інтерфейс дозволяє завантажувати, аналізувати та навігувати документами XML. Нижче наведено простий приклад того, як завантажити XML-файл, перейти по його структурі та читати атрибути та текстовий вміст.

```basic
' Перш за все, переконайтесь, що ви додали посилання на "Microsoft XML, v6.0" через Tools -> References
Dim xmlDoc As MSXML2.DOMDocument60
Set xmlDoc = New MSXML2.DOMDocument60
xmlDoc.async = False
xmlDoc.Load("C:\Шлях\До\Вашого\File.xml") ' Завантажте ваш XML-файл

' Перевірте, чи XML було завантажено успішно
If xmlDoc.parseError.ErrorCode <> 0 Then
    MsgBox "Помилка завантаження XML:" & xmlDoc.parseError.reason
Else
    ' Навігація та читання елементів
    Dim book As IXMLDOMNode
    Set book = xmlDoc.SelectSingleNode("//book/title") ' XPath для пошуку першого <title> всередині <book>
    MsgBox book.Text ' Показати текст заголовка
End If
```

У наведеному вище прикладі коду ми створюємо екземпляр `MSXML2.DOMDocument60`, завантажуємо XML-файл і потім перевіряємо на наявність помилок. Якщо помилок не знайдено, ми переходимо до конкретного вузла, використовуючи XPath, і відображаємо його текстовий вміст.

## Поглиблений аналіз:

Інтеграція можливостей XML у VBA датується початком 2000-х років, коли зросла потреба взаємодії застосунків Office з веб-даними та службами. Бібліотека `MSXML`, або служби ядра Microsoft XML, розвивались протягом років, причому `MSXML2.DOMDocument60` є однією з останніх версій, рекомендованих до використання через її покращену продуктивність та можливості безпеки.

Хоча й потужні, можливості обробки XML у VBA вважаються менш ефективними та більш обтяжливими порівняно з сучасними програмними середовищами, такими як XML.etree в Python або LINQ to XML в C#. Властива мові VBA громіздкість та необхідність вручну додавати та керувати посиланнями може стримувати швидку розробку. Більше того, з появою JSON як більш легковажного формату обміну даними, багато програмістів та застосунків відходять від використання XML, якщо тільки інтероперабельність із застарілими системами або специфічними корпоративними службами не вимагає його використання.

Однак, для завдань, які вимагають аналізу або генерації XML-документів у контексті автоматизації застосунків Microsoft Office, використання можливостей обробки XML у VBA залишається життєздатним і іноді необхідним підходом. Це забезпечує баланс між доступом до багатого набору функцій застосунків Office та можливостями обробки структурованих даних, які надаються XML.
