---
title:                "Рефакторинг"
aliases:
- uk/vba/refactoring.md
date:                  2024-02-01T22:00:14.529051-07:00
model:                 gpt-4-0125-preview
simple_title:         "Рефакторинг"
tag:                  "Good Coding Practices"
editURL:              "https://github.com/dogweather/forkful/blob/master/content/uk/vba/refactoring.md"
changelog:
  - 2024-02-01, gpt-4-0125-preview, translated from English
---

{{< edit_this_page >}}

## Що і чому?

Рефакторинг у програмуванні полягає у зміні структури коду без зміни його поведінки для покращення аспектів, як-от читабельність, можливості підтримки чи продуктивності. Програмісти рефакторять код, щоб зробити його більш ефективним, зрозумілим, легшим для модифікації в майбутньому та зменшити ймовірність помилок.

## Як це робити:

Розглянемо простий приклад на Visual Basic for Applications (VBA), де ми маємо підпрограму, яка друкує деталі про співробітника. Спочатку код є неструктурованим, важко підтримуваним або розширюваним.

```vb
Sub PrintEmployeeDetails()
    Dim name As String
    Dim age As Integer
    Dim department As String
    name = "John Doe"
    age = 30
    department = "IT"
    
    MsgBox "Name: " & name & vbCrLf & "Age: " & age & vbCrLf & "Department: " & department
End Sub
```

Крок 1 рефакторингу: Виділення методу. Один з найпоширеніших прийомів рефакторингу полягає в тому, щоб взяти певну частину коду і перемістити її у власний метод. Це робить код більш модульним і легшим для розуміння.

```vb
Sub PrintEmployeeDetails()
    Dim name As String
    Dim age As Integer
    Dim department As String
    name = "John Doe"
    age = 30
    department = "IT"
    
    DisplayMessage name, age, department
End Sub

Private Sub DisplayMessage(name As String, age As Integer, department As String)
    MsgBox "Name: " & name & vbCrLf & "Age: " & age & vbCrLf & "Department: " & department
End Sub
```

Крок 2 рефакторингу: Використання структури. Цей крок передбачає використання даних структур для зберігання пов'язаних даних, покращення чіткості коду та спрощення передачі груп даних.

```vb
Type Employee
    name As String
    age As Integer
    department As String
End Type

Sub PrintEmployeeDetails()
    Dim emp As Employee
    emp.name = "John Doe"
    emp.age = 30
    emp.department = "IT"
    
    DisplayMessage emp
End Sub

Private Sub DisplayMessage(emp As Employee)
    MsgBox "Name: " & emp.name & vbCrLf & "Age: " & emp.age & vbCrLf & "Department: " & emp.department
End Sub
```

Ці кроки перетворюють неструктурований код на модульний, структурований код, значно покращуючи читабельність і можливості підтримки.

## Поглиблений розгляд

Концепція рефакторингу стара як програмування, але книга Мартіна Фаулера "Рефакторинг: Покращення дизайну існуючого коду" вивела його на головний план, підкресливши його важливість у процесі розробки програмного забезпечення. У Visual Basic for Applications рефакторинг може бути дещо складнішим через відсутність вбудованих інструментів, які знаходяться у більш сучасних інтегрованих середовищах розробки (IDEs), що підтримують автоматизований рефакторинг.

Однак це не зменшує його важливості. Навіть у VBA застосування базових технік рефакторингу вручну може значно покращити базу коду, роблячи її чистішою та більш ефективною. Хоча у VBA може не бути таких же сучасних зручностей, принципи гарного дизайну коду залишаються універсальними. Розробники з інших мов можуть вважати ручний процес нудним, але безсумнівно оцінять переваги, вкладені в час на покращення якості коду з самого початку.

Для більш робастних середовищ розробки або при роботі над особливо складними проектами може бути варто дослідити альтернативи, які пропонують більш потужні інструменти для рефакторингу, або конвертувати проекти VBA в мову .NET, де Visual Studio надає широку підтримку рефакторингу. Тим не менш, розуміння і застосування принципів рефакторингу в VBA є цінним навиком, який підкреслює важливість написання чистого, легкого для підтримки коду, незалежно від середовища.
