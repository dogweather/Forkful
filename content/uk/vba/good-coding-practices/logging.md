---
title:                "Журналювання"
date:                  2024-02-01T21:56:47.326326-07:00
model:                 gpt-4-0125-preview
simple_title:         "Журналювання"
tag:                  "Good Coding Practices"
editURL:              "https://github.com/dogweather/forkful/blob/master/content/uk/vba/logging.md"
changelog:
  - 2024-02-01, gpt-4-0125-preview, translated from English
---

{{< edit_this_page >}}

## Що і чому?

Логування в Visual Basic for Applications (VBA) передбачає запис інформації про поведінку програми під час виконання у файл, консоль або базу даних. Програмісти використовують логування для моніторингу своїх додатків, діагностики проблем та розуміння характеристик продуктивності.

## Як:

У VBA немає вбудованого фреймворку логування, як у деяких інших мовах. Однак, реалізація простого механізму логування є досить простою. Нижче наведено приклад того, як створити базовий логер для файлів.

1. **Запис до файлу логу**: Ця прикладна функція, `LogMessage`, записує повідомлення у текстовий файл з часовою міткою.

```basic
Sub LogMessage(message As String)
    Dim logFilePath As String
    Dim fileNum As Integer
    
    ' Вказати шлях до файлу логу
    logFilePath = ThisWorkbook.Path & "\log.txt"
    
    ' Отримати наступний доступний номер файлу
    fileNum = FreeFile()
    
    ' Відкрити файл для додавання
    Open logFilePath For Append As #fileNum
    
    ' Записати часову мітку та лог-повідомлення
    Print #fileNum, Now & ": " & message
    
    ' Закрити файл
    Close #fileNum
End Sub
```

Щоб залогувати повідомлення, просто викличте `LogMessage("Ваше повідомлення тут")`. Це створює записи в *log.txt* на кшталт:

```
30.04.2023 15:45:32: Ваше повідомлення тут
```

2. **Читання з файлу логу**: Щоб прочитати та відобразити вміст файлу логу:

```basic
Sub ReadLogFile()
    Dim logFilePath As String
    Dim fileContent As String
    Dim fileNum As Integer
    
    logFilePath = ThisWorkbook.Path & "\log.txt"
    fileNum = FreeFile()
    
    ' Відкрити файл для читання
    Open logFilePath For Input As #fileNum
    
    ' Прочитати весь вміст файлу
    fileContent = Input(LOF(fileNum), fileNum)
    
    ' Закрити файл
    Close #fileNum
    
    ' Відобразити вміст файлу
    MsgBox fileContent
End Sub
```

## Поглиблене вивчення

Логування в VBA, через відсутність нативного фреймворку логування, зазвичай реалізується за допомогою базових операцій з файлами або з використанням потужностей зовнішніх COM об'єктів для більш складних потреб, таких як логування до бази даних або взаємодія з Windows Event Log. Історично логування в VBA було способом обходу обмежень, накладених його простими засобами обробки помилок та інструментами відлагодження. Хоча пряме маніпулювання файлами для логування ефективне, воно є первісним і може бути неефективним при великому обсязі даних або при високій одночасності. Для більш витончених можливостей логування програмісти часто звертаються до зовнішніх бібліотек або інтегруються з системами, спеціально призначеними для логування, такими як стек ELK (Elasticsearch, Logstash, Kibana) або Splunk, через виклики веб-сервісів або посередницькі бази даних. Хоча VBA не пропонує сучасних зручностей, які зустрічаються в новіших мовах програмування, розуміння його можливостей та обмежень дозволяє програмістам ефективно використовувати логування як потужний інструмент для моніторингу додатків та діагностики.
