---
title:                "Обробка помилок"
aliases:
- /uk/vba/handling-errors/
date:                  2024-02-01T21:55:57.604593-07:00
model:                 gpt-4-0125-preview
simple_title:         "Обробка помилок"
tag:                  "Good Coding Practices"
editURL:              "https://github.com/dogweather/forkful/blob/master/content/uk/vba/handling-errors.md"
changelog:
  - 2024-02-01, gpt-4-0125-preview, translated from English
---

{{< edit_this_page >}}

## Що і Чому?

Обробка помилок у Visual Basic для додатків (VBA) відноситься до процесу передбачення, виявлення та вирішення помилок програмування, застосунку або зв'язку. Впровадження надійної обробки помилок є критично важливим для підтримання цілісності застосунків та покращення досвіду користувача шляхом граційного управління неочікуваними проблемами без виклику раптових збоїв або втрати даних.

## Як:

У VBA обробка помилок зазвичай реалізується за допомогою оператора `On Error`, який вказує VBA, як діяти, коли виникає помилка. Найпоширеніші стратегії обробки помилок включають `On Error GoTo` мітка, `On Error Resume Next` та `On Error GoTo 0`.

**Приклад 1: Використання `On Error GoTo`**

Цей підхід дозволяє спрямувати програму до певного розділу коду, позначеного відразу після виявлення помилки.

```vb
Sub ErrorHandlerExample()
    On Error GoTo ErrHandler
    Dim intDivision As Integer

    intDivision = 5 / 0 ' Це спричинить помилку ділення на нуль

    Exit Sub
ErrHandler:
    MsgBox "Виникла помилка: " & Err.Description, vbCritical, "Помилка!"
    Resume Next
End Sub
```

У цьому прикладі будь-яка помилка виконання спричинить перехід до `ErrHandler`, виведення повідомлення про помилку, а потім продовжить із наступного рядка після помилки.

**Приклад 2: Використання `On Error Resume Next`**

Ця стратегія вказує VBA продовжувати виконання наступного рядка коду, навіть якщо виникає помилка, що може бути корисним для помилок, які очікуються бути нешкідливими або коли ви плануєте обробити помилку пізніше в ході виконання.

```vb
Sub ResumeNextExample()
    On Error Resume Next
    Dim intDivision As Integer
    intDivision = 5 / 0 ' Це не спричинить зупинку програми; помилка ігнорується
    
    ' Перевірка, чи сталася помилка
    If Err.Number <> 0 Then
        MsgBox "Виникла помилка: " & Err.Description, vbExclamation, "Оброблена помилка"
        ' Скидання помилки
        Err.Clear
    End If
End Sub
```

У цьому випадку програма не зупиняється на помилці; вона перевіряє, чи сталася помилка, обробляє її, якщо так, а потім очищує помилку.

## Поглиблений аналіз

Історично обробка помилок у мовах програмування еволюціонувала від простих операторів goto до більш складних механізмів, як-от винятки у таких мовах, як Java і C#. Обробка помилок у VBA, хоча і не настільки потужна або гнучка, як сучасна обробка винятків, виконує свої функції в контексті застосування мови для автоматизації задач в середовищах Microsoft Office.

Основне обмеження обробки помилок у VBA полягає у її дещо незручному та ручному підході, що вимагає уважного розміщення коду обробки помилок та чіткого розуміння потоку виконання. Сучасні мови програмування зазвичай пропонують більш елегантні рішення, такі як блоки try-catch, які автоматично управляють потоком до коду обробки помилок без необхідності в ручних перевірках або переходах у виконанні коду.

Незважаючи на ці обмеження, механізми обробки помилок у VBA підходять для більшості завдань автоматизації і, якщо використовувати їх належним чином, можуть значно знизити ймовірність неконтрольованих помилок, які викликають проблеми для користувачів. Крім того, розуміння обробки помилок у VBA може надати уявлення про старі парадигми програмування та еволюцію стратегій обробки помилок у розробці програмного забезпечення.
