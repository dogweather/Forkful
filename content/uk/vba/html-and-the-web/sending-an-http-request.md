---
title:                "Надсилання HTTP-запиту"
aliases:
- /uk/vba/sending-an-http-request/
date:                  2024-02-01T22:02:38.807085-07:00
model:                 gpt-4-0125-preview
simple_title:         "Надсилання HTTP-запиту"
tag:                  "HTML and the Web"
editURL:              "https://github.com/dogweather/forkful/blob/master/content/uk/vba/sending-an-http-request.md"
changelog:
  - 2024-02-01, gpt-4-0125-preview, translated from English
---

{{< edit_this_page >}}

## Що і Чому?

Відправлення HTTP-запиту в Visual Basic for Applications (VBA) передбачає програмне доступ до веб-ресурсів або веб-сервісів шляхом створення запитів через HTTP. Програмісти роблять це, щоб отримати дані, взаємодіяти з онлайн API або програмно відправляти форми зі своїх додатків, що підтримують VBA, таких як Excel, Access або користувацькі рішення на VBA.

## Як це зробити:

Ключ до відправлення HTTP-запиту в VBA - це використання бібліотеки `Microsoft XML, v6.0` (або старіших версій, залежно від вашої системи). Спочатку, переконайтеся, що це посилання активовано у вашому проекті, перейшовши в редакторі VBA до Tools > References і вибравши `Microsoft XML, v6.0`.

Ось як відправити простий HTTP GET запит:

```vb
Dim httpRequest As Object
Set httpRequest = CreateObject("MSXML2.XMLHTTP.6.0")

With httpRequest
    .Open "GET", "https://api.example.com/data", False
    .send
    If .Status = 200 Then
        Debug.Print .responseText
    Else
        Debug.Print "Помилка: " & .Status & " - " & .statusText
    End If
End With
```

Для POST-запиту, коли нам потрібно відправити дані (наприклад, JSON) на сервер:

```vb
Dim httpRequest As Object, postData As String
Set httpRequest = CreateObject("MSXML2.XMLHTTP.6.0")
postData = "{""key"":""value""}"

With httpRequest
    .Open "POST", "https://api.example.com/submit", False
    .setRequestHeader "Content-Type", "application/json"
    .send postData
    If .Status = 200 Then
        Debug.Print .responseText
    Else
        Debug.Print "Помилка: " & .Status & " - " & .statusText
    End If
End With
```

Приклад виводу для успішного запиту може бути рядком JSON або сторінкою HTML, залежно від API або веб-сторінки, з якою ви взаємодієте:

```
{"data": "Це відповідь з сервера"}
```

## Поглиблений аналіз

Метод, що демонструється, використовує об'єкт `MSXML2.XMLHTTP`, який є частиною служб Microsoft XML Core Services (MSXML). Він був запроваджений, щоб надати розробникам VBA спосіб виконання операцій на основі XML і з часом став звичайним інструментом для HTTP-запитів, навіть коли робота не пов'язана безпосередньо з даними XML. Незважаючи на свої роки, він залишається надійним варіантом для простих веб-взаємодій у VBA.

Проте, VBA та його механізми HTTP-запиту поступаються за надійністю та гнучкістю сучасним програмним середовищам. Наприклад, обробка асинхронних запитів або робота в додатках, що вимагають передових HTTP-функцій (як-от вебсокети або події, що відсилаються сервером), виходить за рамки можливостей VBA. При роботі над складнішими проектами веб-інтеграції розробники часто вдаються до зовнішніх бібліотек або інструментів або навіть автоматизують поведінку браузера через техніки веб-скрапінгу, хоча це скоріше обхідні шляхи, а не рішення.

Мови та середовища, такі як Python з його бібліотекою `requests` або JavaScript, що виконується на Node.js, пропонують більш потужні та універсальні можливості HTTP-запитів прямо з коробки, включаючи асинхронні операції, легше оброблення JSON та широку підтримку різних веб-технологій. Розробники, що активно працюють у екосистемі Microsoft, можуть розглядати перехід на PowerShell або C# для завдань, що вимагають більш складної веб-взаємодії, використовуючи широкі можливості мережевого програмування .NET.

Таким чином, хоча можливості VBA для HTTP-запитів є достатніми для простих запитів та завдань отримання даних, розвідка альтернатив стає критично важливою, коли вимоги вашого проекту еволюціонують до складнішого та сучасного веб-ландшафту.
