---
title:                "Завантаження веб-сторінки"
date:                  2024-02-01T21:53:17.328801-07:00
model:                 gpt-4-0125-preview
simple_title:         "Завантаження веб-сторінки"
tag:                  "HTML and the Web"
editURL:              "https://github.com/dogweather/forkful/blob/master/content/uk/vba/downloading-a-web-page.md"
changelog:
  - 2024-02-01, gpt-4-0125-preview, translated from English
---

{{< edit_this_page >}}

## Що і чому?

Завантаження веб-сторінки у Visual Basic for Applications (VBA) включає отримання HTML-вмісту веб-сторінки з Інтернету. Програмісти часто виконують це завдання для програмної обробки або аналізу вмісту веб-сайтів зсередини Excel, Access або інших додатків Office.

## Як це зробити:

Щоб завантажити веб-сторінку у VBA, ви можете скористатися бібліотекою Microsoft XML, v6.0 (MSXML6), яка дозволяє виконувати серверні HTTP-запити. Перед початком роботи з кодом, переконайтеся, що ви активували це посилання у вашому редакторі VBA, перейшовши до `Tools` -> `References` і відзначивши `Microsoft XML, v6.0`.

Ось простий приклад того, як завантажити HTML-вміст веб-сторінки:

```basic
Sub DownloadWebPage()
    Dim request As Object
    Dim url As String
    Dim response As String
    
    ' Ініціалізуємо об'єкт XML HTTP-запиту
    Set request = CreateObject("MSXML2.XMLHTTP")
    
    url = "http://www.example.com"
    
    ' Відкриваємо синхронний запит
    request.Open "GET", url, False
    
    ' Надсилаємо запит на сервер
    request.send
    
    ' Отримуємо текст відповіді
    response = request.responseText
    
    ' Виводимо відповідь у вікно негайного виконання (для цілей налагодження)
    Debug.Print response
    
    ' Видаляємо використане
    Set request = Nothing
End Sub
```

Виконання цієї підпрограми виведе HTML `http://www.example.com` до Негайного вікна у редакторі VBA. Зауважте, що параметр `False` у методі `Open` робить запит синхронним, тобто код буде чекати, поки веб-сторінка буде завантажена, перш ніж переходити до наступного рядка.

## Глибинний розбір

Показана техніка спирається на MSXML, реалізацію Microsoft стандарту XML HTTP Request, часто використовуваного для AJAX-запитів у веб-розробці. Цей компонент давно є частиною технологічного стека Microsoft, що робить його надійним вибором для мережевих запитів у VBA.

Однак, спирання на MSXML та VBA для завантаження та аналізу веб-вмісту може бути обмежувальним, особливо з сучасними веб-додатками, які активно використовують JavaScript для динамічного рендерингу контенту. Ці обмеження можуть зробити інші мови або інструменти, такі як Python з бібліотеками, типу BeautifulSoup або Selenium, більш підходящими для завдань веб-скрапінгу завдяки їхній здатності виконувати JavaScript та керувати складними взаємодіями на сайтах.

Незважаючи на це, для простих завдань, які включають отримання простого HTML-вмісту або при роботі в рамках додатків Office, VBA залишається практичним інструментом. Його інтеграція в пакет Office дозволяє безпосередньо маніпулювати документами на основі вмісту веб-сайтів, пропонуючи унікальну перевагу для конкретних випадків використання.
