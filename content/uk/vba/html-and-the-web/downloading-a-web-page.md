---
changelog:
- 2024-02-01, gpt-4-0125-preview, translated from English
date: 2024-02-01 21:53:17.328801-07:00
description: "\u0417\u0430\u0432\u0430\u043D\u0442\u0430\u0436\u0435\u043D\u043D\u044F\
  \ \u0432\u0435\u0431-\u0441\u0442\u043E\u0440\u0456\u043D\u043A\u0438 \u0443 Visual\
  \ Basic for Applications (VBA) \u0432\u043A\u043B\u044E\u0447\u0430\u0454 \u043E\
  \u0442\u0440\u0438\u043C\u0430\u043D\u043D\u044F HTML-\u0432\u043C\u0456\u0441\u0442\
  \u0443 \u0432\u0435\u0431-\u0441\u0442\u043E\u0440\u0456\u043D\u043A\u0438 \u0437\
  \ \u0406\u043D\u0442\u0435\u0440\u043D\u0435\u0442\u0443. \u041F\u0440\u043E\u0433\
  \u0440\u0430\u043C\u0456\u0441\u0442\u0438 \u0447\u0430\u0441\u0442\u043E \u0432\
  \u0438\u043A\u043E\u043D\u0443\u044E\u0442\u044C \u0446\u0435\u2026"
lastmod: '2024-03-13T22:44:49.007190-06:00'
model: gpt-4-0125-preview
summary: "\u0417\u0430\u0432\u0430\u043D\u0442\u0430\u0436\u0435\u043D\u043D\u044F\
  \ \u0432\u0435\u0431-\u0441\u0442\u043E\u0440\u0456\u043D\u043A\u0438 \u0443 Visual\
  \ Basic for Applications (VBA) \u0432\u043A\u043B\u044E\u0447\u0430\u0454 \u043E\
  \u0442\u0440\u0438\u043C\u0430\u043D\u043D\u044F HTML-\u0432\u043C\u0456\u0441\u0442\
  \u0443 \u0432\u0435\u0431-\u0441\u0442\u043E\u0440\u0456\u043D\u043A\u0438 \u0437\
  \ \u0406\u043D\u0442\u0435\u0440\u043D\u0435\u0442\u0443."
title: "\u0417\u0430\u0432\u0430\u043D\u0442\u0430\u0436\u0435\u043D\u043D\u044F \u0432\
  \u0435\u0431-\u0441\u0442\u043E\u0440\u0456\u043D\u043A\u0438"
weight: 42
---

## Як це зробити:
Щоб завантажити веб-сторінку у VBA, ви можете скористатися бібліотекою Microsoft XML, v6.0 (MSXML6), яка дозволяє виконувати серверні HTTP-запити. Перед початком роботи з кодом, переконайтеся, що ви активували це посилання у вашому редакторі VBA, перейшовши до `Tools` -> `References` і відзначивши `Microsoft XML, v6.0`.

Ось простий приклад того, як завантажити HTML-вміст веб-сторінки:

```basic
Sub DownloadWebPage()
    Dim request As Object
    Dim url As String
    Dim response As String
    
    ' Ініціалізуємо об'єкт XML HTTP-запиту
    Set request = CreateObject("MSXML2.XMLHTTP")
    
    url = "http://www.example.com"
    
    ' Відкриваємо синхронний запит
    request.Open "GET", url, False
    
    ' Надсилаємо запит на сервер
    request.send
    
    ' Отримуємо текст відповіді
    response = request.responseText
    
    ' Виводимо відповідь у вікно негайного виконання (для цілей налагодження)
    Debug.Print response
    
    ' Видаляємо використане
    Set request = Nothing
End Sub
```

Виконання цієї підпрограми виведе HTML `http://www.example.com` до Негайного вікна у редакторі VBA. Зауважте, що параметр `False` у методі `Open` робить запит синхронним, тобто код буде чекати, поки веб-сторінка буде завантажена, перш ніж переходити до наступного рядка.

## Глибинний розбір
Показана техніка спирається на MSXML, реалізацію Microsoft стандарту XML HTTP Request, часто використовуваного для AJAX-запитів у веб-розробці. Цей компонент давно є частиною технологічного стека Microsoft, що робить його надійним вибором для мережевих запитів у VBA.

Однак, спирання на MSXML та VBA для завантаження та аналізу веб-вмісту може бути обмежувальним, особливо з сучасними веб-додатками, які активно використовують JavaScript для динамічного рендерингу контенту. Ці обмеження можуть зробити інші мови або інструменти, такі як Python з бібліотеками, типу BeautifulSoup або Selenium, більш підходящими для завдань веб-скрапінгу завдяки їхній здатності виконувати JavaScript та керувати складними взаємодіями на сайтах.

Незважаючи на це, для простих завдань, які включають отримання простого HTML-вмісту або при роботі в рамках додатків Office, VBA залишається практичним інструментом. Його інтеграція в пакет Office дозволяє безпосередньо маніпулювати документами на основі вмісту веб-сайтів, пропонуючи унікальну перевагу для конкретних випадків використання.
