---
title:                "Читання аргументів командного рядка"
aliases:
- uk/vba/reading-command-line-arguments.md
date:                  2024-02-01T21:59:55.341403-07:00
model:                 gpt-4-0125-preview
simple_title:         "Читання аргументів командного рядка"
tag:                  "Files and I/O"
editURL:              "https://github.com/dogweather/forkful/blob/master/content/uk/vba/reading-command-line-arguments.md"
changelog:
  - 2024-02-01, gpt-4-0125-preview, translated from English
---

{{< edit_this_page >}}

## Що і чому?

Читання аргументів командного рядка у Visual Basic for Applications (VBA) передбачає доступ до параметрів, які передаються вашій програмі під час виконання. Ця техніка часто використовується для впливу на поведінку або вивід програми без потреби взаємодії з користувачем, що значно спрощує та робить більш універсальними завдання автоматизації та скриптів.

## Як це зробити:

На відміну від більш простих програмних середовищ, VBA не має вбудованої функції для безпосереднього читання аргументів командного рядка в звичайному розумінні, оскільки вона переважно розроблена для вбудовування в додатки Microsoft Office. Однак, з допомогою трохи креативності, ми можемо використовувати Windows Script Host (WSH) або викликати зовнішні API для досягнення подібної функціональності. Ось практичне обхідне рішення за допомогою WSH:

1. **Створіть VBScript для передачі аргументів до VBA:**

   Спершу напишіть файл VBScript (*yourScript.vbs*), який запускає вашу VBA програму (наприклад, макрос Excel) і передає аргументи командного рядка:

```vb
Set objExcel = CreateObject("Excel.Application")
objExcel.Workbooks.Open "C:\YourMacroWorkbook.xlsm"
objExcel.Run "YourMacroName", WScript.Arguments.Item(0), WScript.Arguments.Item(1)
objExcel.Quit
```

2. **Доступ до Аргументів в VBA:**

   У вашій VBA програмі (*YourMacroWorkbook.xlsm*), змініть або створіть макрос (*YourMacroName*), щоб приймати параметри:

```vb
Sub YourMacroName(arg1 As String, arg2 As String)
    MsgBox "Argument 1: " & arg1 & " Argument 2: " & arg2
End Sub
```

3. **Виконайте Ваш Скрипт:**

   Виконайте VBScript з командного рядка, передаючи аргументи за потреби:

```shell
cscript yourScript.vbs "Hello" "World"
```

   Це має призвести до виконання вашого VBA макросу з аргументами "Hello" та "World", виводячи їх у діалоговому вікні.

## Поглиблений Аналіз:

У історичному контексті, VBA було розроблено для розширення можливостей додатків Microsoft Office, а не як самостійне програмне середовище. Таким чином, безпосередня взаємодія з командним рядком виходить за рамки її основної мети, що пояснює відсутність вбудованої підтримки для читання аргументів командного рядка.

Описаний вище метод, хоча й ефективний, є більше обхідним рішенням, ніж рідним рішенням, використовуючи зовнішні скрипти для подолання цього процесу. Такий підхід може вносити складність і потенційні проблеми з безпекою, оскільки вимагає включення макросів і потенційно зниження налаштувань безпеки для виконання.

Для завдань, які сильно залежать від аргументів командного рядка або потребують більш гладкої інтеграції з операційною системою Windows, інші мови програмування, такі як PowerShell або Python, можуть запропонувати більш надійні та безпечні рішення. Ці альтернативи надають пряму підтримку аргументів командного рядка та краще підходять для самостійних програм або скриптів, яким потрібен зовнішній вхід для динамічної зміни їх поведінки.
