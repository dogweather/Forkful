---
aliases:
- /uk/vba/reading-a-text-file/
changelog:
- 2024-02-01, gpt-4-0125-preview, translated from English
date: 2024-02-01 21:58:42.672380-07:00
description: "\u0427\u0438\u0442\u0430\u043D\u043D\u044F \u0442\u0435\u043A\u0441\u0442\
  \u043E\u0432\u043E\u0433\u043E \u0444\u0430\u0439\u043B\u0443 \u0432 Visual Basic\
  \ for Applications (VBA) \u043F\u0435\u0440\u0435\u0434\u0431\u0430\u0447\u0430\u0454\
  \ \u043F\u0440\u043E\u0433\u0440\u0430\u043C\u043D\u0438\u0439 \u0434\u043E\u0441\
  \u0442\u0443\u043F \u0434\u043E \u0442\u0435\u043A\u0441\u0442\u043E\u0432\u043E\
  \u0433\u043E \u0444\u0430\u0439\u043B\u0443 \u0456 \u0432\u0438\u043B\u0443\u0447\
  \u0435\u043D\u043D\u044F \u0439\u043E\u0433\u043E \u0432\u043C\u0456\u0441\u0442\
  \u0443 \u0437\u0441\u0435\u0440\u0435\u0434\u0438\u043D\u0438 \u043E\u0444\u0456\
  \u0441\u043D\u043E\u0457\u2026"
lastmod: 2024-02-18 23:09:00.076833
model: gpt-4-0125-preview
summary: "\u0427\u0438\u0442\u0430\u043D\u043D\u044F \u0442\u0435\u043A\u0441\u0442\
  \u043E\u0432\u043E\u0433\u043E \u0444\u0430\u0439\u043B\u0443 \u0432 Visual Basic\
  \ for Applications (VBA) \u043F\u0435\u0440\u0435\u0434\u0431\u0430\u0447\u0430\u0454\
  \ \u043F\u0440\u043E\u0433\u0440\u0430\u043C\u043D\u0438\u0439 \u0434\u043E\u0441\
  \u0442\u0443\u043F \u0434\u043E \u0442\u0435\u043A\u0441\u0442\u043E\u0432\u043E\
  \u0433\u043E \u0444\u0430\u0439\u043B\u0443 \u0456 \u0432\u0438\u043B\u0443\u0447\
  \u0435\u043D\u043D\u044F \u0439\u043E\u0433\u043E \u0432\u043C\u0456\u0441\u0442\
  \u0443 \u0437\u0441\u0435\u0440\u0435\u0434\u0438\u043D\u0438 \u043E\u0444\u0456\
  \u0441\u043D\u043E\u0457\u2026"
title: "\u0427\u0438\u0442\u0430\u043D\u043D\u044F \u0442\u0435\u043A\u0441\u0442\u043E\
  \u0432\u043E\u0433\u043E \u0444\u0430\u0439\u043B\u0443"
---

{{< edit_this_page >}}

## Що та Чому?

Читання текстового файлу в Visual Basic for Applications (VBA) передбачає програмний доступ до текстового файлу і вилучення його вмісту зсередини офісної програми. Програмісти часто виконують це завдання для імпорту або обробки даних, збережених у плоских файлах, що сприяє автоматизації та маніпуляції з даними безпосередньо в екосистемі Office.

## Як:

Найпростіший спосіб прочитати текстовий файл у VBA - використання оператора `Open` у поєднанні з функціями `Input` або `Line Input`. Ось як це можна зробити:

1. **Відкрити файл для читання** - Спершу вам потрібно відкрити файл. Переконайтеся, що шлях до файлу доступний для програми.

```basic
Open "C:\example.txt" For Input As #1
```

2. **Читати вміст файлу** - Ви можете читати файл построково за допомогою `Line Input` або весь файл за один раз за допомогою `Input`.

- **Читання построково:**

```basic
Dim fileContent As String
While Not EOF(1) ' EOF = Кінець Файлу
    Line Input #1, fileContent
    Debug.Print fileContent ' Виводить строку в вікно Immediate
Wend
Close #1
```

- **Читання всього файлу за один раз:**

```basic
Dim fileContent As String
Dim fileSize As Long
fileSize = LOF(1) ' LOF = Довжина Файлу
If fileSize > 0 Then
    fileContent = Input(fileSize, #1)
    Debug.Print fileContent
End If
Close #1
```

3. **Приклад виводу**:

Припускаючи, що `example.txt` містить:

```
Привіт,
Це приклад текстового файлу.
На здоровʼя читайте!
```

Вивід у вікні Immediate буде повним текстом або построково, залежно від обраного вами методу.

## Поглиблено

Читання текстових файлів у VBA було основоположним елементом завдань автоматизації офісу протягом десятиліть. Методи, представлені вище, хоч і ефективні в екосистемі VBA, можуть здатися застарілими порівняно з сучасними програмними практиками, які часто використовують вищі рівні абстракції або бібліотеки для роботи з файлами. Наприклад, Python використовує функцію `open()` в межах оператора `with`, забезпечуючи більш чистий синтаксис та автоматичне управління файлами.

Тим не менш, працюючи в межах середовища Microsoft Office, VBA забезпечує прямий і рідний метод маніпуляції з файлами, що може бути важливим для додатків, які вимагають взаємодії з продуктами Office. Простота відкриття текстового файлу, читання та обробки його вмісту построково або в цілому, без необхідності використання зовнішніх бібліотек або складних конфігурацій, роблять VBA цінним інструментом у наборі засобів розробника Office.

Хоча існують кращі альтернативи у сучасних мовах програмування для ефективнішого та легшого управління файлами, розуміння та використання можливостей VBA для читання текстових файлів можуть значно підвищити продуктивність та розширити функціональність додатків на базі Office.
