---
changelog:
- 2024-02-01, gpt-4-0125-preview, translated from English
date: 2024-02-01 22:10:07.253763-07:00
description: "\u0417\u0430\u043F\u0438\u0441 \u0432 \u0441\u0442\u0430\u043D\u0434\
  \u0430\u0440\u0442\u043D\u0438\u0439 \u043F\u043E\u0442\u0456\u043A \u043F\u043E\
  \u043C\u0438\u043B\u043E\u043A \u0443 Visual Basic for Applications (VBA) \u043F\
  \u0435\u0440\u0435\u0434\u0431\u0430\u0447\u0430\u0454 \u043D\u0430\u043F\u0440\u0430\
  \u0432\u043B\u0435\u043D\u043D\u044F \u043F\u043E\u0432\u0456\u0434\u043E\u043C\u043B\
  \u0435\u043D\u044C \u043F\u0440\u043E \u043F\u043E\u043C\u0438\u043B\u043A\u0438\
  \ \u0430\u0431\u043E \u0434\u0456\u0430\u0433\u043D\u043E\u0441\u0442\u0438\u0447\
  \u043D\u0438\u0445 \u043F\u043E\u0432\u0456\u0434\u043E\u043C\u043B\u0435\u043D\u044C\
  \u2026"
lastmod: '2024-03-13T22:44:49.038219-06:00'
model: gpt-4-0125-preview
summary: "\u0417\u0430\u043F\u0438\u0441 \u0432 \u0441\u0442\u0430\u043D\u0434\u0430\
  \u0440\u0442\u043D\u0438\u0439 \u043F\u043E\u0442\u0456\u043A \u043F\u043E\u043C\
  \u0438\u043B\u043E\u043A \u0443 Visual Basic for Applications (VBA) \u043F\u0435\
  \u0440\u0435\u0434\u0431\u0430\u0447\u0430\u0454 \u043D\u0430\u043F\u0440\u0430\u0432\
  \u043B\u0435\u043D\u043D\u044F \u043F\u043E\u0432\u0456\u0434\u043E\u043C\u043B\u0435\
  \u043D\u044C \u043F\u0440\u043E \u043F\u043E\u043C\u0438\u043B\u043A\u0438 \u0430\
  \u0431\u043E \u0434\u0456\u0430\u0433\u043D\u043E\u0441\u0442\u0438\u0447\u043D\u0438\
  \u0445 \u043F\u043E\u0432\u0456\u0434\u043E\u043C\u043B\u0435\u043D\u044C \u043E\
  \u043A\u0440\u0435\u043C\u043E \u0432\u0456\u0434 \u0441\u0442\u0430\u043D\u0434\
  \u0430\u0440\u0442\u043D\u043E\u0433\u043E \u0432\u0438\u0432\u043E\u0434\u0443\
  , \u0437\u0430\u0437\u0432\u0438\u0447\u0430\u0439 \u0434\u043E \u043A\u043E\u043D\
  \u0441\u043E\u043B\u0456 \u0430\u0431\u043E \u0444\u0430\u0439\u043B\u0443 \u0436\
  \u0443\u0440\u043D\u0430\u043B\u0443."
title: "\u0417\u0430\u043F\u0438\u0441 \u0434\u043E \u0441\u0442\u0430\u043D\u0434\
  \u0430\u0440\u0442\u043D\u043E\u0457 \u043F\u043E\u043C\u0438\u043B\u043A\u0438"
weight: 25
---

## Як це зробити:
У VBA, оскільки немає безпосередньо вбудованої функції для запису спеціально у стандартний потік помилок, як у деяких інших мовах програмування, загальноприйнятим обходом є використання `Debug.Print` для виводу помилок під час розробки або створення спеціалізованої функції журналювання, що імітує цю поведінку для продакшн-додатків. Нижче наведено приклад, як ви можете реалізувати та використовувати таку функцію:

```vb
Sub WriteToErrorLog(msg As String)
    ' Спеціалізована функція для імітації запису у стандартний потік помилок
    ' При фактичному використанні, це може записувати до окремого файлу журналу або до спеціального вікна налагодження
    Open "ErrorLog.txt" For Append As #1 ' Змініть "ErrorLog.txt" на шлях до вашого файлу журналу
    Print #1, "ERROR: " & msg
    Close #1
    Debug.Print "ERROR: " & msg ' Також виводиться в негайне вікно в IDE для налагодження розробника
End Sub

Sub Demonstration()
    ' Приклад використання функції WriteToErrorLog
    WriteToErrorLog "Під час обробки вашого запиту сталася помилка."
End Sub
```

Приклад виводу у "ErrorLog.txt" може виглядати так:
```
ERROR: Під час обробки вашого запиту сталася помилка.
```

І в негайному вікні у VBA IDE:
```
ERROR: Під час обробки вашого запиту сталася помилка.
```

## Глибоке занурення
Visual Basic for Applications за замовчуванням не включає спеціалізований механізм для запису в стандартний потік помилок через його глибоку інтеграцію з хост-додатками, такими як Excel, Word або Access, які традиційно покладаються на графічні користувальницькі інтерфейси замість консольного виводу. Це помітне відхилення від консольних додатків, зазвичай розроблених на мовах програмування, таких як C або Python, де основними концепціями є потоки стандартного виводу та стандартної помилки.

Історично, у VBA завжди більше уваги приділялось взаємодії з моделями документів його хост-додатків, а не традиційним механізмам журналювання додатків. Тому, розробники часто вдаються до реалізації власних рішень для журналювання, як у наведеному прикладі, або використовують виклики Windows API для більш складної обробки помилок і потреб журналювання.

Хоча запропонований підхід є обходом, розробники, які шукають більш надійні рішення для журналювання та обробки помилок, можуть розглядати інтеграцію з зовнішніми системами або бібліотеками, здатними на більш складне журналювання. У сучасній розробці, особливо з акцентом на налагодження та обслуговування, важливість чіткого, контекстуального та окремого журналювання стандартних і помилкових виводів не можна переоцінити, змушуючи багатьох шукати рішення за межами нативних можливостей VBA.
