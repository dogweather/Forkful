---
title:                "Запис до стандартної помилки"
aliases:
- /uk/vba/writing-to-standard-error/
date:                  2024-02-01T22:10:07.253763-07:00
model:                 gpt-4-0125-preview
simple_title:         "Запис до стандартної помилки"
tag:                  "Files and I/O"
editURL:              "https://github.com/dogweather/forkful/blob/master/content/uk/vba/writing-to-standard-error.md"
changelog:
  - 2024-02-01, gpt-4-0125-preview, translated from English
---

{{< edit_this_page >}}

## Що і чому?

Запис в стандартний потік помилок у Visual Basic for Applications (VBA) передбачає направлення повідомлень про помилки або діагностичних повідомлень окремо від стандартного виводу, зазвичай до консолі або файлу журналу. Програмісти роблять це, щоб відокремити регулярний вивід програми від повідомлень про помилки, що робить легшим процес налагодження програм або попередження користувачів про проблеми без засмічення основного виводу.

## Як це зробити:

У VBA, оскільки немає безпосередньо вбудованої функції для запису спеціально у стандартний потік помилок, як у деяких інших мовах програмування, загальноприйнятим обходом є використання `Debug.Print` для виводу помилок під час розробки або створення спеціалізованої функції журналювання, що імітує цю поведінку для продакшн-додатків. Нижче наведено приклад, як ви можете реалізувати та використовувати таку функцію:

```vb
Sub WriteToErrorLog(msg As String)
    ' Спеціалізована функція для імітації запису у стандартний потік помилок
    ' При фактичному використанні, це може записувати до окремого файлу журналу або до спеціального вікна налагодження
    Open "ErrorLog.txt" For Append As #1 ' Змініть "ErrorLog.txt" на шлях до вашого файлу журналу
    Print #1, "ERROR: " & msg
    Close #1
    Debug.Print "ERROR: " & msg ' Також виводиться в негайне вікно в IDE для налагодження розробника
End Sub

Sub Demonstration()
    ' Приклад використання функції WriteToErrorLog
    WriteToErrorLog "Під час обробки вашого запиту сталася помилка."
End Sub
```

Приклад виводу у "ErrorLog.txt" може виглядати так:
```
ERROR: Під час обробки вашого запиту сталася помилка.
```

І в негайному вікні у VBA IDE:
```
ERROR: Під час обробки вашого запиту сталася помилка.
```

## Глибоке занурення

Visual Basic for Applications за замовчуванням не включає спеціалізований механізм для запису в стандартний потік помилок через його глибоку інтеграцію з хост-додатками, такими як Excel, Word або Access, які традиційно покладаються на графічні користувальницькі інтерфейси замість консольного виводу. Це помітне відхилення від консольних додатків, зазвичай розроблених на мовах програмування, таких як C або Python, де основними концепціями є потоки стандартного виводу та стандартної помилки.

Історично, у VBA завжди більше уваги приділялось взаємодії з моделями документів його хост-додатків, а не традиційним механізмам журналювання додатків. Тому, розробники часто вдаються до реалізації власних рішень для журналювання, як у наведеному прикладі, або використовують виклики Windows API для більш складної обробки помилок і потреб журналювання.

Хоча запропонований підхід є обходом, розробники, які шукають більш надійні рішення для журналювання та обробки помилок, можуть розглядати інтеграцію з зовнішніми системами або бібліотеками, здатними на більш складне журналювання. У сучасній розробці, особливо з акцентом на налагодження та обслуговування, важливість чіткого, контекстуального та окремого журналювання стандартних і помилкових виводів не можна переоцінити, змушуючи багатьох шукати рішення за межами нативних можливостей VBA.
