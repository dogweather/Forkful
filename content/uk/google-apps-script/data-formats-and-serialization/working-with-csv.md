---
aliases:
- /uk/google-apps-script/working-with-csv/
changelog:
- 2024-02-01, gpt-4-0125-preview, translated from English
date: 2024-02-01 22:06:12.913538-07:00
description: "\u0420\u043E\u0431\u043E\u0442\u0430 \u0437 \u0444\u0430\u0439\u043B\
  \u0430\u043C\u0438 CSV (Comma-Separated Values, \u0437\u043D\u0430\u0447\u0435\u043D\
  \u043D\u044F, \u0449\u043E \u0440\u043E\u0437\u0434\u0456\u043B\u0435\u043D\u0456\
  \ \u043A\u043E\u043C\u0430\u043C\u0438) \u0443 Google Apps Script \u043F\u0435\u0440\
  \u0435\u0434\u0431\u0430\u0447\u0430\u0454 \u0447\u0438\u0442\u0430\u043D\u043D\u044F\
  , \u043C\u043E\u0434\u0438\u0444\u0456\u043A\u0430\u0446\u0456\u044E \u0442\u0430\
  \ \u0437\u0430\u043F\u0438\u0441 \u0437\u0432\u0438\u0447\u0430\u0439\u043D\u0438\
  \u0445\u2026"
lastmod: 2024-02-18 23:08:59.770452
model: gpt-4-0125-preview
summary: "\u0420\u043E\u0431\u043E\u0442\u0430 \u0437 \u0444\u0430\u0439\u043B\u0430\
  \u043C\u0438 CSV (Comma-Separated Values, \u0437\u043D\u0430\u0447\u0435\u043D\u043D\
  \u044F, \u0449\u043E \u0440\u043E\u0437\u0434\u0456\u043B\u0435\u043D\u0456 \u043A\
  \u043E\u043C\u0430\u043C\u0438) \u0443 Google Apps Script \u043F\u0435\u0440\u0435\
  \u0434\u0431\u0430\u0447\u0430\u0454 \u0447\u0438\u0442\u0430\u043D\u043D\u044F\
  , \u043C\u043E\u0434\u0438\u0444\u0456\u043A\u0430\u0446\u0456\u044E \u0442\u0430\
  \ \u0437\u0430\u043F\u0438\u0441 \u0437\u0432\u0438\u0447\u0430\u0439\u043D\u0438\
  \u0445\u2026"
title: "\u0420\u043E\u0431\u043E\u0442\u0430 \u0437 CSV"
---

{{< edit_this_page >}}

## Що та чому?

Робота з файлами CSV (Comma-Separated Values, значення, що розділені комами) у Google Apps Script передбачає читання, модифікацію та запис звичайних текстових файлів, де кожен рядок представляє запис даних, значення в якому розділені комами. Програмісти роблять це для легкого обміну даними між різними додатками, базами даних або мовами програмування завдяки широкому прийняттю CSV як простого текстового формату обміну даними.

## Як:

### Читання даних CSV

Щоб прочитати дані CSV з файлу, збереженого в Google Drive, спочатку потрібно отримати вміст файлу як рядок, а потім розібрати його. Google Apps Script робить отримання вмісту файлу простим за допомогою сервісу DriveApp.

```javascript
function readCSV() {
  var fileId = 'YOUR_FILE_ID_HERE'; // Замініть на актуальний ідентифікатор файлу
  var file = DriveApp.getFileById(fileId);
  var content = file.getBlob().getDataAsString();
  var rows = content.split("\n");
  
  for (var i = 0; i < rows.length; i++) {
    var cells = rows[i].split(",");
    Logger.log(cells); // Реєстрація комірок кожного рядка
  }
}
```

### Запис даних CSV

Створення та запис у CSV передбачає конструювання рядка з комами-роздільниками значень та переводами рядка, а потім збереження або експорт його. Цей приклад демонструє створення нового файлу CSV у Google Drive.

```javascript
function writeCSV() {
  var folderId = 'YOUR_FOLDER_ID_HERE'; // Замініть на ідентифікатор папки Drive, де буде створено новий файл
  var csvContent = "Name,Age,Occupation\nJohn Doe,29,Engineer\nJane Smith,34,Designer";
  var fileName = "example.csv";
  
  var folder = DriveApp.getFolderById(folderId);
  folder.createFile(fileName, csvContent, MimeType.PLAIN_TEXT);
}
```

### Приклад виводу

При реєстрації комірок рядків при читанні CSV:

```plaintext
[John, 29, Engineer]
[Jane, 34, Designer]
```

При записі створюється файл з назвою "example.csv" і вмістом:

```plaintext
Name,Age,Occupation
John Doe,29,Engineer
Jane Smith,34,Designer
```

## Поглиблено

Історично, файли CSV користувалися популярністю через їхню простоту та читабельність для людей, що робило їх доступними для не-програмістів і корисними для завдань швидкого огляду даних. Однак, Google Apps Script діє в межах екосистеми Google, де Google Sheets служить потужною, зручною для користувача альтернативою для маніпуляцій з CSV. Sheets не лише надають графічний інтерфейс для редагування даних, але й підтримують складні формули, стилізацію та багато інших функцій, яких не має сирих CSV.

Попри переваги, які надає Google Sheets, пряма маніпуляція з файлами CSV у Google Apps Script залишається важливою для автоматизованих завдань, зокрема коли йдеться про роботу з зовнішніми системами, що генерують або потребують дані у форматі CSV. Наприклад, інтеграція зі старими системами, експорт даних для використання в інших додатках або попередня обробка перед поданням даних в Google Sheets.

Більше того, можливість Google Apps Script працювати з файлами CSV може бути розширена за допомогою сервісу Utilities для потреб у складному кодуванні або взаємодії з зовнішніми API для завдань конвертації, розбору або перевірки. Однак, для роботи з великими наборами даних або потребі у складних маніпуляціях, розгляньте можливість використання Google Sheets API або дослідження BigQuery для більш потужних можливостей обробки даних.

У той час як простота залишається ключовою причиною популярності CSV, ці альтернативи пропонують багатший набір можливостей для роботи з даними в широкій екосистемі Google Cloud.
