---
changelog:
- 2024-02-03, gpt-4-0125-preview, translated from English
date: 2024-02-03 18:13:41.394403-07:00
description: "\u0423 \u0441\u0444\u0435\u0440\u0456 \u043F\u0440\u043E\u0433\u0440\
  \u0430\u043C\u0443\u0432\u0430\u043D\u043D\u044F \u0440\u043E\u0431\u043E\u0442\u0430\
  \ \u0437 \u0444\u0430\u0439\u043B\u0430\u043C\u0438 CSV (\u0437\u043D\u0430\u0447\
  \u0435\u043D\u043D\u044F, \u0440\u043E\u0437\u0434\u0456\u043B\u0435\u043D\u0456\
  \ \u043A\u043E\u043C\u0430\u043C\u0438) \u0432\u043A\u043B\u044E\u0447\u0430\u0454\
  \ \u0447\u0438\u0442\u0430\u043D\u043D\u044F \u0442\u0430 \u0437\u0430\u043F\u0438\
  \u0441 \u0434\u0430\u043D\u0438\u0445 \u0434\u043E \u0442\u0435\u043A\u0441\u0442\
  \u043E\u0432\u0438\u0445 \u0444\u0430\u0439\u043B\u0456\u0432, \u043E\u0440\u0433\
  \u0430\u043D\u0456\u0437\u043E\u0432\u0430\u043D\u0438\u0445 \u0440\u044F\u0434\u043A\
  \u0430\u043C\u0438, \u0434\u0435\u2026"
lastmod: '2024-03-13T22:44:50.189260-06:00'
model: gpt-4-0125-preview
summary: "\u0423 \u0441\u0444\u0435\u0440\u0456 \u043F\u0440\u043E\u0433\u0440\u0430\
  \u043C\u0443\u0432\u0430\u043D\u043D\u044F \u0440\u043E\u0431\u043E\u0442\u0430\
  \ \u0437 \u0444\u0430\u0439\u043B\u0430\u043C\u0438 CSV (\u0437\u043D\u0430\u0447\
  \u0435\u043D\u043D\u044F, \u0440\u043E\u0437\u0434\u0456\u043B\u0435\u043D\u0456\
  \ \u043A\u043E\u043C\u0430\u043C\u0438) \u0432\u043A\u043B\u044E\u0447\u0430\u0454\
  \ \u0447\u0438\u0442\u0430\u043D\u043D\u044F \u0442\u0430 \u0437\u0430\u043F\u0438\
  \u0441 \u0434\u0430\u043D\u0438\u0445 \u0434\u043E \u0442\u0435\u043A\u0441\u0442\
  \u043E\u0432\u0438\u0445 \u0444\u0430\u0439\u043B\u0456\u0432, \u043E\u0440\u0433\
  \u0430\u043D\u0456\u0437\u043E\u0432\u0430\u043D\u0438\u0445 \u0440\u044F\u0434\u043A\
  \u0430\u043C\u0438, \u0434\u0435 \u043A\u043E\u0436\u0435\u043D \u0440\u044F\u0434\
  \u043E\u043A \u043F\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043B\u044F\u0454\
  \ \u0437\u0430\u043F\u0438\u0441, \u0430 \u043F\u043E\u043B\u044F \u043A\u043E\u0436\
  \u043D\u043E\u0433\u043E \u0437\u0430\u043F\u0438\u0441\u0443 \u0440\u043E\u0437\
  \u0434\u0456\u043B\u0435\u043D\u0456 \u043A\u043E\u043C\u0430\u043C\u0438."
title: "\u0420\u043E\u0431\u043E\u0442\u0430 \u0437 CSV"
weight: 37
---

## Як:


### Читання файлів CSV
Для читання файлу CSV у C ми використовуємо стандартні функції вводу/виводу файлів разом з функціями маніпуляції з рядками для парсингу кожного рядка. Нижче наведено базовий приклад читання файлу CSV і виведення полів кожного рядка у консоль.

```c
#include <stdio.h>
#include <string.h>

int main() {
    FILE *fp = fopen("data.csv", "r");
    if (!fp) {
        printf("Не можу відкрити файл\n");
        return 1;
    }

    char buf[1024];
    while (fgets(buf, 1024, fp)) {
        char *field = strtok(buf, ",");
        while(field) {
            printf("%s\n", field);
            field = strtok(NULL, ",");
        }
    }

    fclose(fp);
    return 0;
}
```
Зразок `data.csv`:
```
Name,Age,Occupation
John Doe,29,Software Engineer
```

Зразок виводу:
```
Name
Age
Occupation
John Doe
29
Software Engineer
```

### Запис у файли CSV
Аналогічно, запис у файл CSV включає використання `fprintf` для збереження даних у форматі, розділеному комами.

```c
#include <stdio.h>

int main() {
    FILE *fp = fopen("output.csv", "w");
    if (!fp) {
        printf("Не можу відкрити файл\n");
        return 1;
    }

    char *headers[] = {"Name", "Age", "Occupation", NULL};
    for (int i = 0; headers[i] != NULL; i++) {
        fprintf(fp, "%s%s", headers[i], (headers[i+1] != NULL) ? "," : "\n");
    }
    fprintf(fp, "%s,%d,%s\n", "Jane Doe", 27, "Data Scientist");

    fclose(fp);
    return 0;
}
```

Зміст зразка `output.csv`:
```
Name,Age,Occupation
Jane Doe,27,Data Scientist
```

## Поглиблений огляд
Формат CSV, хоча й на перший погляд простий, має свої нюанси, такі як обробка ком в межах полів та інкапсуляція полів у лапки. Представлені базові приклади не враховують такі складності, а також не обробляють потенційні помилки надійно.

Історично, обробка CSV у C в основному була ручною через низькорівневу природу мови та відсутність вбудованих абстракцій високого рівня для таких завдань. Це ручне управління включає відкриття файлів, читання рядків, розбиття рядків на частини та перетворення типів даних за потреби.

Хоча пряма маніпуляція файлами CSV у C забезпечує цінний досвід навчання з вводу/виводу файлів і обробки рядків, кілька сучасних альтернатив обіцяють ефективність і менш схильні до помилок процеси. Бібліотеки, такі як `libcsv` та `csv-parser`, пропонують комплексні функції для читання та запису файлів CSV, включаючи підтримку цитованих полів та користувацьких розділових знаків.

Альтернативно, при роботі в екосистемах, які це підтримують, інтеграція з мовами або платформами, що надають функції маніпуляції з CSV високого рівня (наприклад, Python з його бібліотекою `pandas`), може бути більш продуктивним шляхом для додатків, які потребують інтенсивної обробки CSV. Такий підхід з використанням різних мов використовує переваги C у плані продуктивності та програмування систем, одночасно використовуючи легкість використання з інших мов для конкретних завдань, таких як обробка CSV.
