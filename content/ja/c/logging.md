---
title:                "ロギング"
date:                  2024-01-26T01:00:51.579408-07:00
model:                 gpt-4-1106-preview
simple_title:         "ロギング"

tag:                  "Good Coding Practices"
editURL:              "https://github.com/dogweather/forkful/blob/master/content/ja/c/logging.md"
---

{{< edit_this_page >}}

## 何となぜ？
ロギングは、基本的にプログラムが何をしているかを記録することであり、通常はメッセージをファイルや端末に書き出すことによって行います。プログラマーは、イベントの追跡、問題の診断、そして時間を越えたアプリケーションの操作の物語を伝える監査証跡を持つためにこれを行います。

## 方法：
基本から始めましょう。Cには組み込みのロギングフレームワークはありませんが、`stdio.h`を使って簡単なロギングを行うことができます。以下の方法です：

```c
#include <stdio.h>
#include <time.h>

void logMessage(const char* message) {
    time_t now;
    time(&now);
    char *date = ctime(&now);
    date[strlen(date) - 1] = '\0'; // ctime() の結果の末尾にある改行を削除する
    printf("[%s] %s\n", date, message);
}

int main() {
    logMessage("アプリケーションが開始しました。");
    // ... ここにあなたのコード ...
    logMessage("アプリケーションが重要な処理をしています。");
    // ... コードを続けます ...
    logMessage("アプリケーションが終了しました。");
    return 0;
}
```

サンプル出力は次のようになるかもしれません：

```
[火 3月 9 12:00:01 2023] アプリケーションが開始しました。
[火 3月 9 12:00:02 2023] アプリケーションが重要な処理をしています。
[火 3月 9 12:00:03 2023] アプリケーションが終了しました。
```

もちろん、実際の世界であれば、端末の代わりにファイルに書き込みをしたり、異なるログレベルを扱ったり、あらかじめ定義されたライブラリを使用することが望まれるかもしれません。

## ディープダイブ
Cでのロギングは、その言語の残りの大部分と同様に、趣のあるしきたりがあります。歴史的に、ロギングは`stderr`やファイルポインターに`fprintf`を使用して行われました。プログラムがより複雑になるにつれて、ロギングのニーズも複雑化し、Unix システム上での`syslog`のようなライブラリが開発され、複数のソースからのロギングを重要度の異なるレベルで扱うことができるようになりました。

現代の風景では、`zlog`、`log4c`、`glog`のようなCのロギングライブラリがたくさんあり、ログローテーション、構造化ロギング、マルチスレッドロギングなど豊かな機能セットが提供されています。これらのソリューションは、ログの冗長性、宛先、フォーマットに関して微調整を可能にします。

ロギングシステムを実装する際には、タイムスタンプのフォーマット、ログファイルの管理、そしてパフォーマンスが検討される必要があります。イベントを相関するためにはロギングのタイムスタンプが重要ですし、ログローテーションはログファイルがあまりにも多くのディスクスペースを消費しないようにします。また、ロギングの行為も、ロギングがボトルネックにならないように、メインアプリケーションのフローに対して迅速でノンブロッキングであるべきです。

## 参考
Cでのロギングライブラリや慣行についてより深く掘り下げるために、これらの資源をチェックしてください：

- GNU `syslog` マニュアル: https://www.gnu.org/software/libc/manual/html_node/Syslog.html
- `zlog`: C向けの高度に設定可能なロギングライブラリ - https://github.com/HardySimpson/zlog
- `log4c`: Log4jを模倣したC向けロギングフレームワーク - http://log4c.sourceforge.net/
- `glog`: Googleのアプリケーションレベルロギングライブラリ - https://github.com/google/glog
