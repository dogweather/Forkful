---
changelog:
- 2024-03-17, gpt-4-0125-preview, translated from English
date: 2024-03-17 21:50:31.837902-06:00
description: "\u0E01\u0E32\u0E23\u0E1B\u0E23\u0E31\u0E1A\u0E42\u0E04\u0E23\u0E07\u0E2A\
  \u0E23\u0E49\u0E32\u0E07\u0E43\u0E2B\u0E21\u0E48\u0E2B\u0E23\u0E37\u0E2D Refactoring\
  \ \u0E04\u0E37\u0E2D\u0E01\u0E23\u0E30\u0E1A\u0E27\u0E19\u0E01\u0E32\u0E23\u0E02\
  \u0E2D\u0E07\u0E01\u0E32\u0E23\u0E42\u0E04\u0E23\u0E07\u0E2A\u0E23\u0E49\u0E32\u0E07\
  \u0E42\u0E04\u0E49\u0E14\u0E04\u0E2D\u0E21\u0E1E\u0E34\u0E27\u0E40\u0E15\u0E2D\u0E23\
  \u0E4C\u0E17\u0E35\u0E48\u0E21\u0E35\u0E2D\u0E22\u0E39\u0E48\u0E42\u0E14\u0E22\u0E44\
  \u0E21\u0E48\u0E40\u0E1B\u0E25\u0E35\u0E48\u0E22\u0E19\u0E41\u0E1B\u0E25\u0E07\u0E1E\
  \u0E24\u0E15\u0E34\u0E01\u0E23\u0E23\u0E21\u0E20\u0E32\u0E22\u0E19\u0E2D\u0E01\u0E02\
  \u0E2D\u0E07\u0E21\u0E31\u0E19\u2026"
lastmod: '2024-03-17T21:57:56.449642-06:00'
model: gpt-4-0125-preview
summary: "\u0E01\u0E32\u0E23\u0E1B\u0E23\u0E31\u0E1A\u0E42\u0E04\u0E23\u0E07\u0E2A\
  \u0E23\u0E49\u0E32\u0E07\u0E43\u0E2B\u0E21\u0E48\u0E2B\u0E23\u0E37\u0E2D Refactoring\
  \ \u0E04\u0E37\u0E2D\u0E01\u0E23\u0E30\u0E1A\u0E27\u0E19\u0E01\u0E32\u0E23\u0E02\
  \u0E2D\u0E07\u0E01\u0E32\u0E23\u0E42\u0E04\u0E23\u0E07\u0E2A\u0E23\u0E49\u0E32\u0E07\
  \u0E42\u0E04\u0E49\u0E14\u0E04\u0E2D\u0E21\u0E1E\u0E34\u0E27\u0E40\u0E15\u0E2D\u0E23\
  \u0E4C\u0E17\u0E35\u0E48\u0E21\u0E35\u0E2D\u0E22\u0E39\u0E48\u0E42\u0E14\u0E22\u0E44\
  \u0E21\u0E48\u0E40\u0E1B\u0E25\u0E35\u0E48\u0E22\u0E19\u0E41\u0E1B\u0E25\u0E07\u0E1E\
  \u0E24\u0E15\u0E34\u0E01\u0E23\u0E23\u0E21\u0E20\u0E32\u0E22\u0E19\u0E2D\u0E01\u0E02\
  \u0E2D\u0E07\u0E21\u0E31\u0E19 \u0E21\u0E38\u0E48\u0E07\u0E21\u0E31\u0E48\u0E19\u0E17\
  \u0E35\u0E48\u0E08\u0E30\u0E1B\u0E23\u0E31\u0E1A\u0E1B\u0E23\u0E38\u0E07\u0E04\u0E38\
  \u0E13\u0E25\u0E31\u0E01\u0E29\u0E13\u0E30\u0E17\u0E35\u0E48\u0E44\u0E21\u0E48\u0E43\
  \u0E0A\u0E48\u0E1F\u0E31\u0E07\u0E01\u0E4C\u0E0A\u0E31\u0E19\u0E02\u0E2D\u0E07\u0E0B\
  \u0E2D\u0E1F\u0E15\u0E4C\u0E41\u0E27\u0E23\u0E4C \u0E42\u0E1B\u0E23\u0E41\u0E01\u0E23\
  \u0E21\u0E40\u0E21\u0E2D\u0E23\u0E4C\u0E17\u0E33\u0E01\u0E32\u0E23 Refactoring \u0E42\
  \u0E04\u0E49\u0E14\u0E40\u0E1E\u0E37\u0E48\u0E2D\u0E43\u0E2B\u0E49\u0E21\u0E31\u0E19\
  \u0E2A\u0E30\u0E2D\u0E32\u0E14\u0E02\u0E36\u0E49\u0E19 \u0E21\u0E35\u0E1B\u0E23\u0E30\
  \u0E2A\u0E34\u0E17\u0E18\u0E34\u0E20\u0E32\u0E1E\u0E21\u0E32\u0E01\u0E02\u0E36\u0E49\
  \u0E19 \u0E41\u0E25\u0E30\u0E07\u0E48\u0E32\u0E22\u0E15\u0E48\u0E2D\u0E01\u0E32\u0E23\
  \u0E40\u0E02\u0E49\u0E32\u0E43\u0E08\u0E0B\u0E36\u0E48\u0E07\u0E17\u0E33\u0E43\u0E2B\
  \u0E49\u0E01\u0E32\u0E23\u0E1A\u0E33\u0E23\u0E38\u0E07\u0E23\u0E31\u0E01\u0E29\u0E32\
  \u0E41\u0E25\u0E30\u0E01\u0E32\u0E23\u0E1E\u0E31\u0E12\u0E19\u0E32\u0E43\u0E19\u0E2D\
  \u0E19\u0E32\u0E04\u0E15\u0E17\u0E33\u0E44\u0E14\u0E49\u0E07\u0E48\u0E32\u0E22\u0E22\
  \u0E34\u0E48\u0E07\u0E02\u0E36\u0E49\u0E19."
title: "\u0E01\u0E32\u0E23\u0E1B\u0E23\u0E31\u0E1A\u0E42\u0E04\u0E23\u0E07\u0E2A\u0E23\
  \u0E49\u0E32\u0E07\u0E42\u0E04\u0E49\u0E14"
weight: 19
---

## วิธีการ:
PowerShell ไม่มีเครื่องมือการ Refactoring อย่างเฉพาะเจาะจงในตัว แต่คุณยังสามารถทำความสะอาดโค้ดของคุณเพื่อความสามารถอ่านและประสิทธิภาพได้ พิจารณาฟังก์ชันที่ทำงานมากเกินไปและวิธีที่เราอาจปรับโครงสร้างใหม่เพื่อความชัดเจน:

```PowerShell
function Get-InventoryData {
    # ฟังก์ชันต้นฉบับที่ผสมผสานการเรียกข้อมูลและการจัดรูปแบบ
    $data = Get-Content -Path 'C:\inventory-list.txt'
    $inventoryData = $data | ForEach-Object {
        $fields = $_ -split ','
        [PSCustomObject]@{
            ItemID = $fields[0]
            Name   = $fields[1]
            Count  = $fields[2]
            Price  = $fields[3]
        }
    }
    $inventoryData | Format-Table -AutoSize
}

# ปรับเปลี่ยนเป็นฟังก์ชันแยกต่างหาก
function Import-InventoryData {
    param($Path)
    Get-Content -Path $Path | ForEach-Object {
        $fields = $_ -split ','
        [PSCustomObject]@{
            ItemID = $fields[0]
            Name   = $fields[1]
            Count  = $fields[2]
            Price  = $fields[3]
        }
    }
}

function Format-InventoryData {
    param($Data)
    $Data | Format-Table -AutoSize
}

# การใช้งาน
$inventory = Import-InventoryData -Path 'C:\inventory-list.txt'
Format-InventoryData -Data $inventory
```

ตัวอย่างการแสดงผล:

```
ItemID Name            Count Price
------ ----            ----- -----
1001   Widget Type A   50    9.99
1002   Gadget Type B   20    14.99
```

## การศึกษาลึก
การ Refactoring ในการเขียนโปรแกรมมีต้นกำเนิดยาวนานไปจนถึงช่วงเริ่มแรกของการพัฒนาซอฟต์แวร์ แม้กระนั้นถูกทำให้เป็นระบบการปฏิบัติในช่วงทศวรรษที่ 1990 หนังสือของมาร์ติน ฟาวเลอร์ "Refactoring: Improving the Design of Existing Code" เป็นหนึ่งในผลงานสำคัญเกี่ยวกับหัวข้อนี้ ซึ่งเน้นถึงความสำคัญของการ Refactoring เพื่อบรรลุโค้ดที่สะอาด

ในขณะที่ PowerShell ไม่มาพร้อมกับเครื่องมือ Refactoring เฉพาะเจาะจงเหมือนบาง Integrated Development Environments (IDEs) สำหรับภาษาอื่น (เช่น Eclipse หรือ Visual Studio) คุณยังสามารถปฏิบัติตามหลักการ Refactoring ที่ดีได้ด้วยตนเอง สิ่งสำคัญที่ต้องจำไว้คือการ Refactoring ไม่ใช่แค่การเปลี่ยนโค้ดเพื่อการเปลี่ยนแปลง แต่เป็นการทำการเปลี่ยนแปลงที่มีเจตนา อนุรักษ์พฤติกรรม ที่เพิ่มพูนโครงสร้างและการออกแบบของโค้ด

ทางเลือกต่อการ Refactoring ด้วยตนเองใน PowerShell รวมถึงการใช้งาน IDEs ที่รองรับภาษานั้น เช่น Visual Studio Code พร้อมส่วนขยาย PowerShell ซึ่งเสนอคุณสมบัติเช่นการจัดรูปแบบโค้ดและความสามารถในการ Refactoring พื้นฐาน สำหรับการ Refactoring ที่สำคัญยิ่งขึ้น คุณอาจพิจารณาใช้การทดสอบ Pester เพื่อให้แน่ใจว่าการเปลี่ยนแปลงไม่ได้เปลี่ยนแปลงฟังก์ชันการทำงาน

นอกจากนี้ การดำเนินการในการ Refactoring อาจเกี่ยวข้องกับการเปลี่ยนแปลงที่โดยรวมมากขึ้นเช่นการ modularization ซึ่งคือการแบ่งโค้ดเป็นโมดูลหรือฟังก์ชันที่สามารถนำกลับมาใช้ใหม่ได้ ซึ่งช่วยปรับปรุงการยึดหลัก DRY (Don't Repeat Yourself) หลักการ Refactoring อื่นๆ ทั่วไป รวมถึงการเปลี่ยนชื่อเพื่อความชัดเจน การลบโค้ดที่ซ้ำซ้อน และการลดความซับซ้อนของเงื่อนไขตรรกะ

## ดูเพิ่มเติม
เพื่อศึกษาเพิ่มเติม นี่คือแหล่งข้อมูลบางส่วน:

- หนังสือ Refactoring ของ Martin Fowler: [_Refactoring: Improving the Design of Existing Code_](https://martinfowler.com/books/refactoring.html)
- การทดสอบโค้ดที่ปรับโครงสร้างใหม่ด้วย Pester: [Pester Testing Framework](https://pester.dev/)
- ทัศนคติและแนวทางปฏิบัติที่ดีที่สุดของ PowerShell: [The PowerShell Best Practices and Style Guide](https://poshcode.gitbooks.io/powershell-practice-and-style/)
