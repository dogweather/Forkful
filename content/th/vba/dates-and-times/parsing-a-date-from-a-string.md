---
changelog:
- 2024-03-17, gpt-4-0125-preview, translated from English
date: 2024-03-17 21:49:38.808302-06:00
description: "\u0E01\u0E32\u0E23\u0E41\u0E22\u0E01\u0E27\u0E34\u0E40\u0E04\u0E23\u0E32\
  \u0E30\u0E2B\u0E4C\u0E27\u0E31\u0E19\u0E17\u0E35\u0E48\u0E08\u0E32\u0E01\u0E2A\u0E15\
  \u0E23\u0E34\u0E07\u0E43\u0E19 Visual Basic for Applications (VBA) \u0E40\u0E1B\u0E47\
  \u0E19\u0E01\u0E32\u0E23\u0E41\u0E1B\u0E25\u0E07\u0E02\u0E49\u0E2D\u0E04\u0E27\u0E32\
  \u0E21\u0E17\u0E35\u0E48\u0E41\u0E17\u0E19\u0E27\u0E31\u0E19\u0E17\u0E35\u0E48\u0E43\
  \u0E2B\u0E49\u0E40\u0E1B\u0E47\u0E19\u0E0A\u0E19\u0E34\u0E14\u0E02\u0E49\u0E2D\u0E21\
  \u0E39\u0E25\u0E27\u0E31\u0E19\u0E17\u0E35\u0E48\u2026"
lastmod: '2024-03-17T21:57:56.048178-06:00'
model: gpt-4-0125-preview
summary: "\u0E01\u0E32\u0E23\u0E41\u0E22\u0E01\u0E27\u0E34\u0E40\u0E04\u0E23\u0E32\
  \u0E30\u0E2B\u0E4C\u0E27\u0E31\u0E19\u0E17\u0E35\u0E48\u0E08\u0E32\u0E01\u0E2A\u0E15\
  \u0E23\u0E34\u0E07\u0E43\u0E19 Visual Basic for Applications (VBA) \u0E40\u0E1B\u0E47\
  \u0E19\u0E01\u0E32\u0E23\u0E41\u0E1B\u0E25\u0E07\u0E02\u0E49\u0E2D\u0E04\u0E27\u0E32\
  \u0E21\u0E17\u0E35\u0E48\u0E41\u0E17\u0E19\u0E27\u0E31\u0E19\u0E17\u0E35\u0E48\u0E43\
  \u0E2B\u0E49\u0E40\u0E1B\u0E47\u0E19\u0E0A\u0E19\u0E34\u0E14\u0E02\u0E49\u0E2D\u0E21\
  \u0E39\u0E25\u0E27\u0E31\u0E19\u0E17\u0E35\u0E48 \u0E42\u0E1B\u0E23\u0E41\u0E01\u0E23\
  \u0E21\u0E40\u0E21\u0E2D\u0E23\u0E4C\u0E17\u0E33\u0E2A\u0E34\u0E48\u0E07\u0E19\u0E35\
  \u0E49\u0E40\u0E1E\u0E37\u0E48\u0E2D\u0E43\u0E2B\u0E49\u0E2A\u0E32\u0E21\u0E32\u0E23\
  \u0E16\u0E08\u0E31\u0E14\u0E01\u0E32\u0E23\u0E01\u0E31\u0E1A\u0E27\u0E31\u0E19\u0E17\
  \u0E35\u0E48\u0E44\u0E14\u0E49\u0E21\u0E35\u0E1B\u0E23\u0E30\u0E2A\u0E34\u0E17\u0E18\
  \u0E34\u0E20\u0E32\u0E1E\u0E21\u0E32\u0E01\u0E02\u0E36\u0E49\u0E19\u0E43\u0E19\u0E41\
  \u0E2D\u0E1B\u0E1E\u0E25\u0E34\u0E40\u0E04\u0E0A\u0E31\u0E19\u0E02\u0E2D\u0E07\u0E1E\
  \u0E27\u0E01\u0E40\u0E02\u0E32 \u0E40\u0E0A\u0E48\u0E19 \u0E2A\u0E33\u0E2B\u0E23\
  \u0E31\u0E1A\u0E01\u0E32\u0E23\u0E40\u0E1B\u0E23\u0E35\u0E22\u0E1A\u0E40\u0E17\u0E35\
  \u0E22\u0E1A \u0E01\u0E32\u0E23\u0E04\u0E33\u0E19\u0E27\u0E13 \u0E2B\u0E23\u0E37\
  \u0E2D\u0E01\u0E32\u0E23\u0E08\u0E31\u0E14\u0E23\u0E39\u0E1B\u0E41\u0E1A\u0E1A."
title: "\u0E01\u0E32\u0E23\u0E41\u0E22\u0E01\u0E27\u0E31\u0E19\u0E17\u0E35\u0E48\u0E2D\
  \u0E2D\u0E01\u0E08\u0E32\u0E01\u0E2A\u0E15\u0E23\u0E34\u0E07"
weight: 30
---

## วิธีการ:
VBA เสนอวิธีที่ตรงไปตรงมาในการแยกวิเคราะห์สตริงเป็นวันที่โดยใช้ฟังก์ชัน `CDate` หรือ `DateValue` อย่างไรก็ตาม สำคัญมากที่สตริงต้องอยู่ในรูปแบบวันที่ที่สามารถระบุได้

ตัวอย่างพื้นฐานโดยใช้ `CDate`:

```basic
Sub ParseDateUsingCDate()
    Dim dateString As String
    Dim parsedDate As Date
    
    dateString = "2023-04-01"
    parsedDate = CDate(dateString)
    
    Debug.Print "Parsed Date: "; parsedDate
End Sub
```

หากคุณรันโค้ดนี้ ผลลัพธ์ในหน้าต่าง Immediate (สามารถเข้าถึงได้ผ่านทาง `Ctrl+G` ในตัวแก้ไข VBA) จะเป็น:

```
Parsed Date: 4/1/2023
```

หรือคุณสามารถใช้ฟังก์ชัน `DateValue` ซึ่งเจาะจงกับวันที่มากขึ้น (ไม่รวมส่วนของเวลา):

```basic
Sub ParseDateUsingDateValue()
    Dim dateString As String
    Dim parsedDate As Date
    
    dateString = "April 1, 2023"
    parsedDate = DateValue(dateString)
    
    Debug.Print "Parsed Date using DateValue: "; parsedDate
End Sub
```

ผลลัพธ์ตัวอย่างสำหรับสิ่งนี้ก็จะแสดงในหน้าต่าง Immediate เช่นกัน:

```
Parsed Date using DateValue: 4/1/2023
```

จำไว้ว่าความสำเร็จในการแยกวิเคราะห์ขึ้นอยู่กับรูปแบบวันที่ของสตริงที่ตรงกับการตั้งค่าของระบบหรือแอปพลิเคชัน

## ดำดิ่งลงไป
เมื่อ VBA แยกวิเคราะห์สตริงเป็นวันที่ มันใช้การตั้งค่าภูมิภาคของระบบปฏิบัติการ Windows เพื่อตีความรูปแบบวันที่ ความเข้าใจนี้สำคัญมากเพราะสตริงวันที่ที่แยกวิเคราะห์ได้สมบูรณ์บนระบบหนึ่งอาจทำให้เกิดข้อผิดพลาดบนอีกระบบหนึ่งหากมีการใช้การตั้งค่าวัน/เวลาที่แตกต่างกัน

โดยประวัติศาสตร์ การจัดการกับวันที่ได้เป็นแหล่งที่มาของข้อผิดพลาดของแอปพลิเคชัน โดยเฉพาะอย่างยิ่งที่ใช้งานในระดับสากล การพึ่งพาการตั้งค่าภูมิภาคใน VBA คือเหตุผลที่บางคนอาจพิจารณาทางเลือกอื่น ๆ เช่น รูปแบบ ISO 8601 (เช่น "YYYY-MM-DD") สำหรับการแสดงและการแยกวิเคราะห์วันที่โดยไม่คลุมเครือในระบบต่างๆ น่าเสียดายที่ VBA ไม่รองรับ ISO 8601 โดยเนื้อแท้และการแยกวิเคราะห์ด้วยตนเองจะต้องใช้สำหรับการปฏิบัติตามอย่างเคร่งครัด

สำหรับการแยกวิเคราะห์วันที่ที่ซับซ้อนกว่าที่ `CDate` หรือ `DateValue` สามารถจัดการได้ หรือเพื่อให้แน่ใจว่าการแยกวิเคราะห์เป็นไปอย่างสม่ำเสมอไม่ว่าการตั้งค่าโลคารจะเป็นเช่นไร โปรแกรมเมอร์อาจหันไปใช้ฟังก์ชันการแยกวิเคราะห์ที่กำหนดเอง ซึ่งอาจรวมถึงการแบ่งสตริงวันที่ออกเป็นส่วนประกอบ (ปี, เดือน, วัน) และสร้างวันที่โดยใช้ฟังก์ชัน `DateSerial` คนอื่นอาจเลือกใช้ภาษาหรือไลบรารีที่มีประสิทธิภาพมากขึ้นที่ออกแบบมาพร้อมกับการคำนึงถึงการนานาชาติสำหรับงานเหล่านี้
