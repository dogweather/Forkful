---
changelog:
- 2024-03-17, gpt-4-0125-preview, translated from English
date: 2024-03-17 21:53:36.224605-06:00
description: "TOML \u0E22\u0E48\u0E2D\u0E21\u0E32\u0E08\u0E32\u0E01 Tom's Obvious,\
  \ Minimal Language \u0E0B\u0E36\u0E48\u0E07\u0E40\u0E1B\u0E47\u0E19\u0E23\u0E39\u0E1B\
  \u0E41\u0E1A\u0E1A\u0E44\u0E1F\u0E25\u0E4C\u0E01\u0E32\u0E23\u0E01\u0E33\u0E2B\u0E19\
  \u0E14\u0E04\u0E48\u0E32\u0E17\u0E35\u0E48\u0E2D\u0E48\u0E32\u0E19\u0E07\u0E48\u0E32\
  \u0E22\u0E40\u0E19\u0E37\u0E48\u0E2D\u0E07\u0E08\u0E32\u0E01\u0E21\u0E35\u0E0B\u0E35\
  \u0E41\u0E21\u0E19\u0E15\u0E34\u0E01\u0E17\u0E35\u0E48\u0E0A\u0E31\u0E14\u0E40\u0E08\
  \u0E19\u2026"
lastmod: '2024-03-17T21:57:55.743249-06:00'
model: gpt-4-0125-preview
summary: "TOML \u0E22\u0E48\u0E2D\u0E21\u0E32\u0E08\u0E32\u0E01 Tom's Obvious, Minimal\
  \ Language \u0E0B\u0E36\u0E48\u0E07\u0E40\u0E1B\u0E47\u0E19\u0E23\u0E39\u0E1B\u0E41\
  \u0E1A\u0E1A\u0E44\u0E1F\u0E25\u0E4C\u0E01\u0E32\u0E23\u0E01\u0E33\u0E2B\u0E19\u0E14\
  \u0E04\u0E48\u0E32\u0E17\u0E35\u0E48\u0E2D\u0E48\u0E32\u0E19\u0E07\u0E48\u0E32\u0E22\
  \u0E40\u0E19\u0E37\u0E48\u0E2D\u0E07\u0E08\u0E32\u0E01\u0E21\u0E35\u0E0B\u0E35\u0E41\
  \u0E21\u0E19\u0E15\u0E34\u0E01\u0E17\u0E35\u0E48\u0E0A\u0E31\u0E14\u0E40\u0E08\u0E19\
  \ \u0E42\u0E1B\u0E23\u0E41\u0E01\u0E23\u0E21\u0E40\u0E21\u0E2D\u0E23\u0E4C\u0E21\
  \u0E31\u0E01\u0E43\u0E0A\u0E49\u0E21\u0E31\u0E19\u0E2A\u0E33\u0E2B\u0E23\u0E31\u0E1A\
  \u0E44\u0E1F\u0E25\u0E4C\u0E01\u0E32\u0E23\u0E01\u0E33\u0E2B\u0E19\u0E14\u0E04\u0E48\
  \u0E32\u0E43\u0E19\u0E41\u0E2D\u0E1B\u0E1E\u0E25\u0E34\u0E40\u0E04\u0E0A\u0E31\u0E19\
  \u0E40\u0E1E\u0E23\u0E32\u0E30\u0E21\u0E31\u0E19\u0E15\u0E23\u0E07\u0E44\u0E1B\u0E15\
  \u0E23\u0E07\u0E21\u0E32\u0E41\u0E25\u0E30\u0E40\u0E1B\u0E47\u0E19\u0E21\u0E34\u0E15\
  \u0E23\u0E01\u0E31\u0E1A\u0E1C\u0E39\u0E49\u0E04\u0E19 \u0E17\u0E33\u0E43\u0E2B\u0E49\
  \u0E01\u0E32\u0E23\u0E08\u0E31\u0E14\u0E01\u0E32\u0E23\u0E01\u0E32\u0E23\u0E15\u0E31\
  \u0E49\u0E07\u0E04\u0E48\u0E32\u0E41\u0E25\u0E30\u0E01\u0E32\u0E23\u0E01\u0E33\u0E2B\
  \u0E19\u0E14\u0E04\u0E48\u0E32\u0E02\u0E2D\u0E07\u0E41\u0E2D\u0E1B\u0E1E\u0E25\u0E34\
  \u0E40\u0E04\u0E0A\u0E31\u0E19\u0E40\u0E1B\u0E47\u0E19\u0E44\u0E1B\u0E2D\u0E22\u0E48\
  \u0E32\u0E07\u0E23\u0E32\u0E1A\u0E23\u0E37\u0E48\u0E19\u0E43\u0E19\u0E2A\u0E20\u0E32\
  \u0E1E\u0E41\u0E27\u0E14\u0E25\u0E49\u0E2D\u0E21\u0E17\u0E35\u0E48\u0E41\u0E15\u0E01\
  \u0E15\u0E48\u0E32\u0E07\u0E01\u0E31\u0E19."
title: "\u0E01\u0E32\u0E23\u0E17\u0E33\u0E07\u0E32\u0E19\u0E23\u0E48\u0E27\u0E21\u0E01\
  \u0E31\u0E1A TOML"
weight: 39
---

## วิธีการ:
เนื่องจาก Google Apps Script เป็นพื้นฐานของ JavaScript ที่มีการเข้าถึงชุดแอปของ Google การทำงานกับ TOML โดยตรงภายใน Google Apps Script จำเป็นต้องใช้ความคิดสร้างสรรค์เล็กน้อย Google Apps Script ไม่รองรับการแยกวิเคราะห์ TOML โดยตรง แต่คุณสามารถใช้ประโยชน์จากไลบรารี JavaScript หรือเขียนตัวแยกวิเคราะห์อย่างง่ายเพื่อความต้องการพื้นฐาน

ลองแยกวิเคราะห์สตริงการกำหนดค่า TOML แบบง่ายเป็นตัวอย่าง:

```javascript
// สตริง TOML
var tomlString = `
[database]
server = "192.168.1.1"
ports = [ 8001, 8001, 8002 ]
connection_max = 5000
enabled = true
`;

// ฟังก์ชันแปลง TOML เป็น JSON อย่างง่าย
function parseTOML(tomlStr) {
  var result = {};
  var currentSection = result;
  tomlStr.split(/\r?\n/).forEach(line => {
    line = line.trim();
    if (line.startsWith('[')) { // ส่วนใหม่
      var sectionName = line.replace(/\[|\]/g, '');
      result[sectionName] = {};
      currentSection = result[sectionName];
    } else if (line) {
      var keyValue = line.split('=').map(part => part.trim());
      var key = keyValue[0];
      var value = eval(keyValue[1]); // ใช้ eval ด้วยความง่าย แต่ระวังในโค้ดการผลิต
      currentSection[key] = value;
    }
  });
  return result;
}

// ทดสอบตัวแยกวิเคราะห์
var configObject = parseTOML(tomlString);
console.log(configObject);

```

ผลลัพธ์จาก `console.log` จะดูเหมือนกับวัตถุ JSON ทำให้การเข้าถึงคุณสมบัติการกำหนดค่าใน Google Apps Script เป็นไปได้อย่างง่ายดาย:

```json
{
  "database": {
    "server": "192.168.1.1",
    "ports": [8001, 8001, 8002],
    "connection_max": 5000,
    "enabled": true
  }
}
```

## ลงรายละเอียด
TOML ถูกสร้างโดย Tom Preston-Werner หนึ่งในผู้ก่อตั้ง GitHub เพื่อให้เป็นมิตรกับมนุษย์มากกว่า JSON สำหรับไฟล์การกำหนดค่า โดยยังคงความสามารถในการถูกแยกวิเคราะห์อย่างไม่กำกวม เป้าหมายคือการทำให้ง่ายที่สุด ซึ่งตรงกับจรรยาบรรณของโครงการพัฒนามากมายที่มุ่งเน้นความเรียบง่ายและความอ่านง่ายในรหัสของพวกเขา

ในบริบทของ Google Apps Script การใช้ TOML อาจเพิ่มภาระงาน เนื่องจากไม่มีการสนับสนุนโดยตรงและจำเป็นต้องแยกวิเคราะห์ด้วยตนเองหรือผ่านไลบรารีบุคคลที่สาม สำหรับโครงการขนาดเล็กหรือโครงการที่ไม่ได้รวมเข้ากับระบบนิเวศของ Google อย่างลึกซึ้ง ทางเลือกอื่นเช่น JSON หรือแม้แต่โครงสร้างคู่คีย์-ค่าในคุณสมบัติสคริปต์อาจเพียงพอและง่ายต่อการนำไปใช้งาน อย่างไรก็ตาม สำหรับแอปพลิเคชันที่ให้ความสำคัญกับไฟล์การกำหนดค่าที่เป็นมิตรกับมนุษย์และมุ่งมั่นใช้ TOML การรวมการแยกวิเคราะห์ TOML ผ่านสคริปต์ที่กำหนดเองเพิ่มความยืดหยุ่นและใช้งานได้ยาวนานโดยไม่ต้องออกจากรูปแบบการกำหนดค่าที่ต้องการ
